"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[85941],{15680:(e,t,n)=>{n.d(t,{xA:()=>g,yg:()=>u});var o=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=o.createContext({}),d=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},g=function(e){var t=d(e.components);return o.createElement(l.Provider,{value:t},e.children)},h="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,g=r(e,["components","mdxType","originalType","parentName"]),h=d(n),c=i,u=h["".concat(l,".").concat(c)]||h[c]||p[c]||a;return n?o.createElement(u,s(s({ref:t},g),{},{components:n})):o.createElement(u,s({ref:t},g))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,s=new Array(a);s[0]=c;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[h]="string"==typeof e?e:i,s[1]=r;for(var d=2;d<a;d++)s[d]=n[d];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},805:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var o=n(58168),i=(n(96540),n(15680));const a={description:"Building a crowd heat map based on Grove Vision AI V2 and Home Assistant.",title:"Building a crowd density based on Grove Vision AI V2 and Home Assistant",keywords:["matter","XIAO","light"],image:"https://files.seeedstudio.com/wiki/seeed_logo/logo_2023.png",slug:"/vision_ai_v2_crowd_heat_map",last_update:{date:"05/22/2024",author:"Citric"}},s="Building a crowd density based on Grove Vision AI V2 and Home Assistant",r={unversionedId:"Sensor/Grove/Grove_Sensors/AI-powered/Grove-vision-ai-v2/Application/vision_ai_v2_crowd_heat_map",id:"Sensor/Grove/Grove_Sensors/AI-powered/Grove-vision-ai-v2/Application/vision_ai_v2_crowd_heat_map",title:"Building a crowd density based on Grove Vision AI V2 and Home Assistant",description:"Building a crowd heat map based on Grove Vision AI V2 and Home Assistant.",source:"@site/docs/Sensor/Grove/Grove_Sensors/AI-powered/Grove-vision-ai-v2/Application/vision_ai_v2_crowd_heat_map.md",sourceDirName:"Sensor/Grove/Grove_Sensors/AI-powered/Grove-vision-ai-v2/Application",slug:"/vision_ai_v2_crowd_heat_map",permalink:"/vision_ai_v2_crowd_heat_map",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Sensor/Grove/Grove_Sensors/AI-powered/Grove-vision-ai-v2/Application/vision_ai_v2_crowd_heat_map.md",tags:[],version:"current",lastUpdatedBy:"Citric",lastUpdatedAt:1716336e3,formattedLastUpdatedAt:"May 22, 2024",frontMatter:{description:"Building a crowd heat map based on Grove Vision AI V2 and Home Assistant.",title:"Building a crowd density based on Grove Vision AI V2 and Home Assistant",keywords:["matter","XIAO","light"],image:"https://files.seeedstudio.com/wiki/seeed_logo/logo_2023.png",slug:"/vision_ai_v2_crowd_heat_map",last_update:{date:"05/22/2024",author:"Citric"}},sidebar:"ProductSidebar",previous:{title:"Intelligent IP Camera With AI Function",permalink:"/grove_vision_ai_v2_webcamera"},next:{title:"Deploy Grove Vision AI V2 To Notifies You Via Telegram",permalink:"/grove_vision_ai_v2_telegram"}},l={},d=[{value:"Hardware Preparation",id:"hardware-preparation",level:2},{value:"Materials Required",id:"materials-required",level:3},{value:"Flash Network Transparency Firmware for XIAO ESP32C3",id:"flash-network-transparency-firmware-for-xiao-esp32c3",level:3},{value:"Installation of plug-ins on Home Assistant",id:"installation-of-plug-ins-on-home-assistant",level:2},{value:"Step 1. Installing EMQX",id:"step-1-installing-emqx",level:3},{value:"Step 2. Installing Advanced SSH &amp; Web Terminal",id:"step-2-installing-advanced-ssh--web-terminal",level:3},{value:"Step 3. Installing Node-RED",id:"step-3-installing-node-red",level:3},{value:"Deploying pysscma via Docker on Home Assistant",id:"deploying-pysscma-via-docker-on-home-assistant",level:2},{value:"Step 4. Accessing the Advanced SSH &amp; Web Terminal",id:"step-4-accessing-the-advanced-ssh--web-terminal",level:3},{value:"Step 5. Downloading the pysscma.tar package",id:"step-5-downloading-the-pysscmatar-package",level:3},{value:"Step 6. Loading the Docker image",id:"step-6-loading-the-docker-image",level:3},{value:"Step 7. Obtaining the IP address",id:"step-7-obtaining-the-ip-address",level:3},{value:"Configure MQTT Broker",id:"configure-mqtt-broker",level:2},{value:"Step 8. Creating a Built-in Database and User",id:"step-8-creating-a-built-in-database-and-user",level:3},{value:"Step 9. Configure the network for Grove Vision AI V2",id:"step-9-configure-the-network-for-grove-vision-ai-v2",level:3},{value:"Configure Node-RED",id:"configure-node-red",level:2},{value:"Step 10. Configure and run Node-RED",id:"step-10-configure-and-run-node-red",level:3},{value:"Step 11. Installing the <code>msg-speed</code> node",id:"step-11-installing-the-msg-speed-node",level:3},{value:"Step 12. Importing the Flow JSON",id:"step-12-importing-the-flow-json",level:3},{value:"Step 13. Configuring the MQTT Broker node",id:"step-13-configuring-the-mqtt-broker-node",level:3},{value:"Step 14. Verifying the POST node URL",id:"step-14-verifying-the-post-node-url",level:3},{value:"Step 15. Deploying the Flow",id:"step-15-deploying-the-flow",level:3},{value:"Crowd Density Dashboard Setup",id:"crowd-density-dashboard-setup",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Q1: What models does this project support?",id:"q1-what-models-does-this-project-support",level:3},{value:"Q2: Why is the dashboard unresponsive after I have turned on the buttons for certain functions?",id:"q2-why-is-the-dashboard-unresponsive-after-i-have-turned-on-the-buttons-for-certain-functions",level:3},{value:"Resources",id:"resources",level:2},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],g={toc:d},h="wrapper";function p(e){let{components:t,...n}=e;return(0,i.yg)(h,(0,o.A)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"building-a-crowd-density-based-on-grove-vision-ai-v2-and-home-assistant"},"Building a crowd density based on Grove Vision AI V2 and Home Assistant"),(0,i.yg)("p",null,"In the era of smart homes and IoT, integrating intelligent sensors and devices into home automation systems has become increasingly popular. ",(0,i.yg)("a",{parentName:"p",href:"https://www.home-assistant.io/"},"Home Assistant"),", a powerful open-source home automation platform, offers a wide range of possibilities for creating custom solutions tailored to individual needs. In this tutorial, we will explore how to build an advanced environment detection system using the Grove Vision AI V2 and XIAO ESP32C3, seamlessly integrated with Home Assistant."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/2.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"The Grove Vision AI V2, a cutting-edge vision sensor, combined with the versatile XIAO ESP32C3 microcontroller, provides an ideal foundation for creating a feature-rich and highly capable environment detection system. By leveraging the power of these devices, we can implement a wide array of functionalities, including multi-model recognition, custom settings, real-time frame rate, live view, target tracking, target heatmap, and cross-area counting."),(0,i.yg)("p",null,"Throughout this tutorial, we will guide you through the step-by-step process of setting up the hardware, configuring the software, and integrating the system with Home Assistant. Whether you are a beginner or an experienced user, this tutorial aims to provide you with the knowledge and tools necessary to create a sophisticated environment detection system that enhances your smart home experience."),(0,i.yg)("p",null,"Get ready to embark on an exciting journey as we unlock the potential of the Grove Vision AI V2 and XIAO ESP32C3, and discover how they can revolutionize the way you monitor and interact with your home environment using Home Assistant. Let's dive in and start building your very own intelligent environment detection system!"),(0,i.yg)("h2",{id:"hardware-preparation"},"Hardware Preparation"),(0,i.yg)("p",null,"Before the tutorial content of this article begins, you may need to have the following hardware ready."),(0,i.yg)("h3",{id:"materials-required"},"Materials Required"),(0,i.yg)("div",{class:"table-center"},(0,i.yg)("table",{align:"center"},(0,i.yg)("tr",null,(0,i.yg)("th",null,"Grove Vision AI V2"),(0,i.yg)("th",null,"XIAO ESP32C3"),(0,i.yg)("th",null,"Home Assistant Green")),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/visionai-v2-ha/43.jpg",style:{width:250,height:"auto"}}))),(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/XIAO_WiFi/board-pic.png",style:{width:120,height:"auto"}}))),(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/visionai-v2-ha/ha.png",style:{width:210,height:"auto"}})))),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Grove-Vision-AI-Module-V2-p-5851.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Seeed-XIAO-ESP32C3-p-5431.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Home-Assistant-Green-p-5792.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f"))))))))),(0,i.yg)("p",null,"Home Assistant Green is the easiest and most privacy-focused way to automate your home. It offers an effortless setup and allows you to control all the smart devices with just one system, where all the data is stored locally by default. This board benefits from the thriving Home Assistant ecosystem and it will be improved every month by open source."),(0,i.yg)("p",null,"We recommend using Home Assistant Green as the Home Assistant host for this tutorial, or you can use any Home Assistant host with a Supervisor."),(0,i.yg)("p",null,"Once you have the Grove Vision AI V2 and camera ready to go, then you can connect them via the CSI connection cable. When connecting, please pay attention to the direction of the row of pins and don't plug them in backwards."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/grove-vision-ai-v2/9.gif",style:{width:400,height:"auto"}})),(0,i.yg)("p",null,"You then need to connect the XIAO and Grove Vision AI V2 via the row of pins (or use the expansion board and Grove interface)."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/grove-vision-ai-v2/10.gif",style:{width:400,height:"auto"}})),(0,i.yg)("p",null,"And we have assumed that you have uploaded a recognition model for the device."),(0,i.yg)("h3",{id:"flash-network-transparency-firmware-for-xiao-esp32c3"},"Flash Network Transparency Firmware for XIAO ESP32C3"),(0,i.yg)("p",null,"Connect the XIAO ESP32C3 to your computer using a suitable USB-C cable. Ensure the device drivers are installed correctly."),(0,i.yg)("p",null,"Open the ",(0,i.yg)("a",{parentName:"p",href:"https://seeed-studio.github.io/SenseCraft-Web-Toolkit/#/tool/tool"},"SenseCraft Model Assistant Tool")," in your web browser."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/visionai-v2-ha/22.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Then select ",(0,i.yg)("strong",{parentName:"p"},"XIAO ESP32S3")," and click ",(0,i.yg)("strong",{parentName:"p"},"Connect"),"."),(0,i.yg)("admonition",{type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"Note that although the XIAO ESP32S3 is selected here, we are still using the XIAO ESP32C3!")),(0,i.yg)("p",null,"Click the button below to download the firmware file and click the ",(0,i.yg)("strong",{parentName:"p"},"Add File")," button on the web page to flash the ",(0,i.yg)("inlineCode",{parentName:"p"},"sscma_xiao_c3_network_v1.1.0.bin")," firmware for the ",(0,i.yg)("inlineCode",{parentName:"p"},"0x0")," address."),(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/sscma_xiao_c3_network_v1.1.0.bin"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"},"Download the file"))))),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/visionai-v2-ha/23.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Finally, click the ",(0,i.yg)("strong",{parentName:"p"},"Flash")," button and wait for the programme to be uploaded successfully before disconnecting the XIAO ESP32C3 from the computer."),(0,i.yg)("h2",{id:"installation-of-plug-ins-on-home-assistant"},"Installation of plug-ins on Home Assistant"),(0,i.yg)("p",null,"Before we begin building our environment detection system, we need to install a few essential add-ons in Home Assistant. These add-ons will provide the necessary functionality and tools to integrate the Grove Vision AI V2 and XIAO ESP32C3 with Home Assistant. The required add-ons are ",(0,i.yg)("strong",{parentName:"p"},"EMQX"),", ",(0,i.yg)("strong",{parentName:"p"},"Advanced SSH & Web Terminal"),", and ",(0,i.yg)("strong",{parentName:"p"},"Node-RED"),". Let's go through the installation process for each add-on."),(0,i.yg)("h3",{id:"step-1-installing-emqx"},"Step 1. Installing EMQX"),(0,i.yg)("p",null,"Open your Home Assistant web interface and navigate to the ",(0,i.yg)("strong",{parentName:"p"},"Settings")," menu. Click on the ",(0,i.yg)("strong",{parentName:"p"},"Add-ons")," option to access the add-on management page."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/4.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"In the bottom right corner of the page, click on the ",(0,i.yg)("strong",{parentName:"p"},"ADD-ON STORE")," button to open the add-on store."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/5.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"In the search bar of the add-on store, type ",(0,i.yg)("strong",{parentName:"p"},"EMQX")," and press enter to search for the add-on."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/6.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"Locate the ",(0,i.yg)("strong",{parentName:"p"},"EMQX")," add-on in the search results and click on it to view its details. Click on the ",(0,i.yg)("strong",{parentName:"p"},"INSTALL")," button to begin the installation process. Home Assistant will download and install the EMQX add-on. Wait for the installation to complete."),(0,i.yg)("h3",{id:"step-2-installing-advanced-ssh--web-terminal"},"Step 2. Installing Advanced SSH & Web Terminal"),(0,i.yg)("p",null,'In the Home Assistant "Add-on Store," search for ',(0,i.yg)("strong",{parentName:"p"},"Advanced SSH & Web Terminal"),"."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/7.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"Locate the ",(0,i.yg)("strong",{parentName:"p"},"Advanced SSH & Web Terminal")," add-on and click on it to view its details. Click on the ",(0,i.yg)("strong",{parentName:"p"},"Install")," button to start the installation process. Home Assistant will download and install the Advanced SSH & Web Terminal add-on."),(0,i.yg)("h3",{id:"step-3-installing-node-red"},"Step 3. Installing Node-RED"),(0,i.yg)("p",null,'Again, in the Home Assistant "Add-on Store," search for ',(0,i.yg)("strong",{parentName:"p"},"Node-RED"),"."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/8.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"Find the ",(0,i.yg)("strong",{parentName:"p"},"Node-RED"),' add-on and click on it to access its details. Click on the "Install" button to initiate the installation process. Allow Home Assistant to download and install the Node-RED add-on.'),(0,i.yg)("h2",{id:"deploying-pysscma-via-docker-on-home-assistant"},"Deploying pysscma via Docker on Home Assistant"),(0,i.yg)("p",null,"In this step, we will download and set up the Python SSCMA (Seeed Studio Cross-platform Modular API) server using the Advanced SSH & Web Terminal add-on in Home Assistant. This server will enable communication between the Grove Vision AI V2 and Home Assistant. Follow the detailed steps below:"),(0,i.yg)("h3",{id:"step-4-accessing-the-advanced-ssh--web-terminal"},"Step 4. Accessing the Advanced SSH & Web Terminal"),(0,i.yg)("p",null,"Open your Home Assistant web interface and navigate to the ",(0,i.yg)("strong",{parentName:"p"},"Settings")," menu. Click on the ",(0,i.yg)("strong",{parentName:"p"},"Add-ons")," option to access the add-on management page. Locate the ",(0,i.yg)("strong",{parentName:"p"},"Advanced SSH & Web Terminal")," add-on and click on it to open its details page."),(0,i.yg)("p",null,"Please turn off the ",(0,i.yg)("strong",{parentName:"p"},"Protection mode")," on this page."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/9.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"Click on the ",(0,i.yg)("strong",{parentName:"p"},"START")," button if the add-on is not already running. Once the add-on is running, click on the ",(0,i.yg)("strong",{parentName:"p"},"OPEN WEB UI")," button to access the terminal interface."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"The first time you launch this plugin you may need to fill in ",(0,i.yg)("inlineCode",{parentName:"p"},"username"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"password")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"authorized_key")," on the configuration page of the plugin details page. For detailed configuration information, please read the documentation provided with the plugin."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/10.png",style:{width:900,height:"auto"}}))),(0,i.yg)("h3",{id:"step-5-downloading-the-pysscmatar-package"},"Step 5. Downloading the pysscma.tar package"),(0,i.yg)("p",null,"In the Advanced SSH & Web Terminal, navigate to the root directory by executing the following command:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"cd /\n")),(0,i.yg)("p",null,"Download the ",(0,i.yg)("strong",{parentName:"p"},"pysscma.tar")," package by running the following command:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"wget -O pysscma.tar https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/pysscma.tar\n")),(0,i.yg)("p",null,"Wait for the download to complete. The ",(0,i.yg)("strong",{parentName:"p"},"pysscma.tar")," package will be saved in the root directory."),(0,i.yg)("h3",{id:"step-6-loading-the-docker-image"},"Step 6. Loading the Docker image"),(0,i.yg)("p",null,"After the download is finished, execute the following command to load the Docker image from the pysscma.tar package:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"docker load -i pysscma.tar\n")),(0,i.yg)("p",null,"Docker will load the image, and you will see the image ID once the process is complete."),(0,i.yg)("p",null,"To start the Python SSCMA server, run the following command:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"docker run -itd --net host --name pysscma_server --restart on-failure --privileged python-sscma:latest server --host 0.0.0.0\n")),(0,i.yg)("p",null,'This command will create and start a Docker container named "pysscma_server" with the necessary configurations.'),(0,i.yg)("p",null,"To check if the Docker container is running properly, execute the following command:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"docker ps\n")),(0,i.yg)("p",null,'You should see the "pysscma_server" container listed with a status of "Up".'),(0,i.yg)("h3",{id:"step-7-obtaining-the-ip-address"},"Step 7. Obtaining the IP address"),(0,i.yg)("p",null,"To get the IP address of the Docker container, run the following command:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"ifconfig | grep docker -A 10\n")),(0,i.yg)("p",null,'Look for the "inet" field in the output, and note down the IP address associated with it (e.g., 172.30.232.1).'),(0,i.yg)("p",null,"This IP address will be used in the subsequent steps to configure the communication between the Grove Vision AI V2."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/1.png",style:{width:900,height:"auto"}})),(0,i.yg)("h2",{id:"configure-mqtt-broker"},"Configure MQTT Broker"),(0,i.yg)("p",null,"In this step, we will configure the EMQX add-on in Home Assistant to set up user authentication for secure communication between the Grove Vision AI V2 and Home Assistant."),(0,i.yg)("h3",{id:"step-8-creating-a-built-in-database-and-user"},"Step 8. Creating a Built-in Database and User"),(0,i.yg)("p",null,'Open your Home Assistant web interface and navigate to the "Settings" menu. Click on the "Add-ons" option to access the add-on management page. Locate the "EMQX" add-on and click on it to open its details page. Click on the "START" button if the add-on is not already running. Once the add-on is running, click on the "OPEN WEB UI" button to access the EMQX Dashboard.'),(0,i.yg)("p",null,"In the EMQX Dashboard login page, enter the default username and password."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Default username: ",(0,i.yg)("strong",{parentName:"li"},"admin")),(0,i.yg)("li",{parentName:"ul"},"Default password: ",(0,i.yg)("strong",{parentName:"li"},"public"))),(0,i.yg)("p",null,'Click on the "Login" button to access the EMQX Dashboard.'),(0,i.yg)("p",null,"In the EMQX Dashboard, navigate to the ",(0,i.yg)("strong",{parentName:"p"},"Authentication")," section from the left sidebar menu. Click on the ",(0,i.yg)("strong",{parentName:"p"},"Databases")," tab."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/11.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"Click on the ",(0,i.yg)("strong",{parentName:"p"},"Create")," button. In the ",(0,i.yg)("strong",{parentName:"p"},"Mechanism")," dropdown, select ",(0,i.yg)("strong",{parentName:"p"},"Password-Based"),", In the ",(0,i.yg)("strong",{parentName:"p"},"Backend")," dropdown, select ",(0,i.yg)("strong",{parentName:"p"},"Built-in Database"),'. Click on the "Create" button to create the Built-in Database.'),(0,i.yg)("p",null,"After creating the Built-in Database, click on the ",(0,i.yg)("strong",{parentName:"p"},"Users"),' tab in the "Authentication" section. Click on the "Add User" button.'),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},'In the "Username" field, enter "seeed".'),(0,i.yg)("li",{parentName:"ul"},'In the "Password" field, enter "seeed".')),(0,i.yg)("p",null,'Go back to the "Databases" tab in the "Authentication" section. Locate the previously created database in the list of databases.'),(0,i.yg)("p",null,'Click on the toggle switch next to the database to enable it. The database status should change to "Enabled".'),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/12.png",style:{width:900,height:"auto"}})),(0,i.yg)("h3",{id:"step-9-configure-the-network-for-grove-vision-ai-v2"},"Step 9. Configure the network for Grove Vision AI V2"),(0,i.yg)("p",null,"Connect the Grove Vision AI V2 to your computer and open the ",(0,i.yg)("a",{parentName:"p",href:"https://seeed-studio.github.io/SenseCraft-Web-Toolkit/#/setup/config"},"Model Assistant's configuration page"),"."),(0,i.yg)("p",null,"After clicking on the top right corner to connect to Grove Vision AI V2, please turn on the MQTT button and enter the following information that you need to fill in the page."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"SSID & Password"),": The device needs to be on the same LAN as the host where the Home Asistant is installed. So please configure the network under the same LAN. XIAO only supports 2.4G WiFi, 5G network is not available."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Encryption"),": Select ",(0,i.yg)("strong",{parentName:"li"},"AUTO"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Host"),": IP address of the host where Home Assistant is installed."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Port"),": ",(0,i.yg)("inlineCode",{parentName:"li"},"1883"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"clientId"),": For the device identification number, please prefix it with ",(0,i.yg)("inlineCode",{parentName:"li"},"grove_vision_ai_v2_")," followed by the custom ID number."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"username"),": The name of the EMQX database you just create."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"password"),": The password of the EMQX database you just create.")),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/13.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"Then click the Save button below. After saving, it ",(0,i.yg)("strong",{parentName:"p"},"does not mean that Grove Vision AI V2 has been written correctly"),", please go back to ",(0,i.yg)("strong",{parentName:"p"},"Process")," in the left menu bar and check if the IP address of the device has appeared and if the status of the MQTT connection is correct."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/visionai-v2-ha/33.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("admonition",{type:"caution"},(0,i.yg)("p",{parentName:"admonition"},"When IP Address is displayed, it means there is no problem with WIFI, and Service status must be the text in the figure to represent normal, note that if WIFI is not normal, MQTT is definitely not normal; when you just switch over, it may show unconnected, and you need to wait for about 10s or so, you don't need to refresh to see the status, and it will show the newest status after the change of the status automatically.")),(0,i.yg)("p",null,"If the connection is working, you can theoretically see the data stream in EMQX."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/3.png",style:{width:900,height:"auto"}})),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"Since the Node-RED connections have not been configured yet, you should see only one All Connections on EMQX.")),(0,i.yg)("h2",{id:"configure-node-red"},"Configure Node-RED"),(0,i.yg)("p",null,"In this step, we will configure the Node-RED add-on in Home Assistant to create the necessary flows for integrating the Grove Vision AI V2 with Home Assistant."),(0,i.yg)("h3",{id:"step-10-configure-and-run-node-red"},"Step 10. Configure and run Node-RED"),(0,i.yg)("p",null,'Open your Home Assistant web interface and navigate to the "Settings" menu. Click on the "Add-ons" option to access the add-on management page. Locate the "Node-RED" add-on and click on it to open its details page. Click on the "Configuration" tab.'),(0,i.yg)("p",null,"In the Node-RED configuration, locate the ",(0,i.yg)("strong",{parentName:"p"},"ssl")," option. Disable ",(0,i.yg)("strong",{parentName:"p"},"ssl")," option. Click on the ",(0,i.yg)("strong",{parentName:"p"},"SAVE")," button to apply the configuration changes."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/14.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,'Click on the "START" button to start the Node-RED add-on. Wait for the add-on to start successfully. You can check the logs to monitor the progress. Once the Node-RED add-on is running, click on the "OPEN WEB UI" button to access the Node-RED Editor.'),(0,i.yg)("h3",{id:"step-11-installing-the-msg-speed-node"},"Step 11. Installing the ",(0,i.yg)("inlineCode",{parentName:"h3"},"msg-speed")," node"),(0,i.yg)("p",null,"In the Node-RED Editor, click on the hamburger menu (three horizontal lines) in the top-right corner. Select ",(0,i.yg)("strong",{parentName:"p"},"Manage palette")," from the menu."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/15.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"In the ",(0,i.yg)("strong",{parentName:"p"},"Palette")," sidebar, click on the ",(0,i.yg)("strong",{parentName:"p"},"Install")," tab. In the search box, type ",(0,i.yg)("strong",{parentName:"p"},"msg-speed")," and press Enter. Locate the ",(0,i.yg)("strong",{parentName:"p"},"msg-speed")," node in the search results and click on the ",(0,i.yg)("strong",{parentName:"p"},"Install"),' button next to it. Wait for the installation to complete, then close the "Palette" sidebar.'),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/16.png",style:{width:900,height:"auto"}})),(0,i.yg)("h3",{id:"step-12-importing-the-flow-json"},"Step 12. Importing the Flow JSON"),(0,i.yg)("p",null,"Please download our prepared JSON file ",(0,i.yg)("inlineCode",{parentName:"p"},"crowd_density.json")," for Flow."),(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/crowd_density.json"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"},"Download the file"))))),(0,i.yg)("p",null,'In the Node-RED Editor, click on the hamburger menu again. Select "Import" from the menu. In the "Import nodes" dialog, click on the "select a file to import" button. Browse and select the provided JSON file that contains the pre-configured Node-RED flow. Click on the "Import" button to import the flow into Node-RED.'),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/17.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"Then you can see our prepared Node-RED Flow."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/18.png",style:{width:900,height:"auto"}})),(0,i.yg)("h3",{id:"step-13-configuring-the-mqtt-broker-node"},"Step 13. Configuring the MQTT Broker node"),(0,i.yg)("p",null,"In the imported flow, locate the ",(0,i.yg)("strong",{parentName:"p"},"mqtt-broker")," node. Double-click on the node to open its configuration."),(0,i.yg)("p",null,'In the "Server" field, enter the IP address of the EMQX broker (e.g., localhost or the IP address of the Home Assistant instance).'),(0,i.yg)("p",null,'In the "Username" field, enter the username you created in the EMQX Database (e.g., "seeed").'),(0,i.yg)("p",null,'In the "Password" field, enter the password you set for the user in the EMQX Database (e.g., "seeed"). Click on the "Done" button to save the MQTT broker configuration.'),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/19.png",style:{width:900,height:"auto"}})),(0,i.yg)("h3",{id:"step-14-verifying-the-post-node-url"},"Step 14. Verifying the POST node URL"),(0,i.yg)("p",null,'In the imported flow, locate the "POST" node. Double-click on the node to open its configuration.'),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/20.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,'Verify that the "URL" field contains the correct IP address of the pysscma Docker container that you obtained in ',(0,i.yg)("strong",{parentName:"p"},(0,i.yg)("a",{parentName:"strong",href:"#step-7-obtaining-the-ip-address"},"Step 7")),'. If necessary, update the URL to match the pysscma Docker IP address. Click on the "Done" button to save the POST node configuration.'),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/21.png",style:{width:900,height:"auto"}})),(0,i.yg)("h3",{id:"step-15-deploying-the-flow"},"Step 15. Deploying the Flow"),(0,i.yg)("p",null,"Click on the ",(0,i.yg)("strong",{parentName:"p"},"Deploy")," button in the top-right corner of the Node-RED Editor to deploy the flow. The flow should now be active and ready to handle data from the Grove Vision AI V2."),(0,i.yg)("h2",{id:"crowd-density-dashboard-setup"},"Crowd Density Dashboard Setup"),(0,i.yg)("p",null,"In this step, we will access the Node-RED dashboard to monitor and interact with the data from the Grove Vision AI V2 device."),(0,i.yg)("p",null,"Open a web browser on your computer or mobile device. In the address bar, enter the URL in the following format:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"http://homeassistant:1880/endpoint/ui/\n")),(0,i.yg)("p",null,"You can now monitor the data flow and interact with the nodes in the Node-RED dashboard."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/vision_ai_v2_heatmap/22.png",style:{width:900,height:"auto"}})),(0,i.yg)("p",null,"First of all, please enter your clientId in the upper left corner. then click the ",(0,i.yg)("strong",{parentName:"p"},"REFRESH")," button and start invoke. Then the Grove Vision AI V2 footage is pushed streaming in real time. You can enable or disable the following functions according to your actual needs."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("strong",{parentName:"p"},"region"),": Enabling this function starts the Cross-Area Counting function. By default, when this function is turned on, the image will be divided into two areas, area A and area B, along the orange line in the middle. When an identification frame travels from area a across the orange line to area b, then the ",(0,i.yg)("strong",{parentName:"p"},"COUNT (A to B)")," on the left side of the centre is increased by 1. Conversely, the ",(0,i.yg)("strong",{parentName:"p"},"COUNT (B to A)")," on the right side is increased by 1."),(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("strong",{parentName:"p"},"pos1"),": This is used to set the position of the left (upper) endpoint of the line segment that divides the area.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("strong",{parentName:"p"},"pos2"),": This is used to set the position of the right (lower) endpoint of the line segment that divides the area.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("strong",{parentName:"p"},"vertical"),": By default, the line segment dividing the area is the horizontal line. When this button is turned on, the line segments become vertical lines.")))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("strong",{parentName:"p"},"box"),": By default, the recognition box is closed. When the button is turned on, the recognition box is displayed in real time in the centre screen.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("strong",{parentName:"p"},"track"),": By default, the functionality of Target Tracking is turned off. If the feature is turned on, then the route taken by the recognised object is plotted as a thin green line in the middle image.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("strong",{parentName:"p"},"label"),": By default, the recognition label is closed. When the button is turned on, the recognition label is displayed in real time in the centre screen.")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("strong",{parentName:"p"},"heatmap"),": By default, Target Heatmap is off. When the button is turned on, the crowd density of the currently detected area is displayed. the redder the colour of an area, the more historical occurrences of monitored objects are detected in that area, and the bluer the less."))),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Performance")," on the far right is the real-time frame rate, Image is the frame rate of the screen transfer, and Overlay is the frame rate of the screen with various functions turned on."),(0,i.yg)("p",null,"The screen in the centre shows the live preview screen with the various functions turned on, and the small window on the right shows the original screen."),(0,i.yg)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,i.yg)("h3",{id:"q1-what-models-does-this-project-support"},"Q1: What models does this project support?"),(0,i.yg)("p",null,"Currently the project only supports models for target recognition, i.e., the class of models with recognition frames, and does not support, for example, models such as Human Pose Detection and Hand Pose Detection."),(0,i.yg)("h3",{id:"q2-why-is-the-dashboard-unresponsive-after-i-have-turned-on-the-buttons-for-certain-functions"},"Q2: Why is the dashboard unresponsive after I have turned on the buttons for certain functions?"),(0,i.yg)("p",null,"As this page is built on Node-RED, the page may not refresh in real time in some cases due to browser kernel optimisation. You can try refreshing the screen by clicking the REFRESH button and the invoke button, or refreshing the current web page."),(0,i.yg)("h2",{id:"resources"},"Resources"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"[GITHUB]")," ",(0,i.yg)("a",{parentName:"li",href:"https://github.com/Seeed-Studio/python-sscma/tree/feat/supervision?tab=readme-ov-file#sample"},"Source code for pysscma"))),(0,i.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,i.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,i.yg)("div",{class:"table-center"},(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,i.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,i.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"}))))}p.isMDXComponent=!0}}]);