"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[26205],{15680:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>h});var a=t(96540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=a.createContext({}),d=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=d(e.components);return a.createElement(l.Provider,{value:n},e.children)},g="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),g=d(t),u=i,h=g["".concat(l,".").concat(u)]||g[u]||p[u]||r;return t?a.createElement(h,s(s({ref:n},c),{},{components:t})):a.createElement(h,s({ref:n},c))}));function h(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,s=new Array(r);s[0]=u;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o[g]="string"==typeof e?e:i,s[1]=o;for(var d=2;d<r;d++)s[d]=t[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},41692:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var a=t(58168),i=(t(96540),t(15680));const r={description:"Using XIAO ESP32C3 to connect to SenseCAP AI for planting advice",title:"Using XIAO ESP32C3 to connect to SenseCAP AI for planting advice",keywords:["xiao","sensecap ai","AI"],image:"https://files.seeedstudio.com/wiki/seeed_logo/logo_2023.png",slug:"/xiao_esp32c3_sensecapai",last_update:{date:"08/04/2023",author:"Citric"}},s="Using XIAO ESP32C3 to connect to SenseCAP AI for planting advice",o={unversionedId:"Cloud_Chain/SenseCAP_AI/xiao-esp32c3-sensecapai",id:"Cloud_Chain/SenseCAP_AI/xiao-esp32c3-sensecapai",title:"Using XIAO ESP32C3 to connect to SenseCAP AI for planting advice",description:"Using XIAO ESP32C3 to connect to SenseCAP AI for planting advice",source:"@site/docs/Cloud_Chain/SenseCAP_AI/xiao-esp32c3-sensecapai.md",sourceDirName:"Cloud_Chain/SenseCAP_AI",slug:"/xiao_esp32c3_sensecapai",permalink:"/xiao_esp32c3_sensecapai",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Cloud_Chain/SenseCAP_AI/xiao-esp32c3-sensecapai.md",tags:[],version:"current",lastUpdatedBy:"Citric",lastUpdatedAt:1691107200,formattedLastUpdatedAt:"Aug 4, 2023",frontMatter:{description:"Using XIAO ESP32C3 to connect to SenseCAP AI for planting advice",title:"Using XIAO ESP32C3 to connect to SenseCAP AI for planting advice",keywords:["xiao","sensecap ai","AI"],image:"https://files.seeedstudio.com/wiki/seeed_logo/logo_2023.png",slug:"/xiao_esp32c3_sensecapai",last_update:{date:"08/04/2023",author:"Citric"}},sidebar:"ProductSidebar",previous:{title:"How to Use SenseCAP AI on SenseCAP Portal and SenseCAP Mate APP",permalink:"/How_to_Use_SenseCAP_AI_on_SenseCAP_Portal_and_SenseCAP_Mate_APP"},next:{title:"SenseCAP API Introduction",permalink:"/Cloud_Chain/SenseCAP_API/SenseCAP_API_Introduction"}},l={},d=[{value:"Getting Started",id:"getting-started",level:2},{value:"Hardware Preparation",id:"hardware-preparation",level:3},{value:"Software Preparation",id:"software-preparation",level:3},{value:"XIAO ESP32C3 Getting Temperature and Humidity Data",id:"xiao-esp32c3-getting-temperature-and-humidity-data",level:2},{value:"Introduction to SenseCAP HTTPS API -- Upload Sensor Data",id:"introduction-to-sensecap-https-api----upload-sensor-data",level:2},{value:"About Header",id:"about-header",level:3},{value:"About Interface",id:"about-interface",level:3},{value:"Upload temperature and humidity data to SenseCAP",id:"upload-temperature-and-humidity-data-to-sensecap",level:2},{value:"Step 1. Register and login to SenseCAP",id:"step-1-register-and-login-to-sensecap",level:3},{value:"Step 2. Obtaining Forensic Information",id:"step-2-obtaining-forensic-information",level:3},{value:"Step 3. Obtaining the number of the sensor type",id:"step-3-obtaining-the-number-of-the-sensor-type",level:3},{value:"Step 4. Install the necessary libraries",id:"step-4-install-the-necessary-libraries",level:3},{value:"Step 5. Uploading sensor data through the program",id:"step-5-uploading-sensor-data-through-the-program",level:3},{value:"Introduction to SenseCAP HTTPS API -- Getting AI Advice",id:"introduction-to-sensecap-https-api----getting-ai-advice",level:2},{value:"About Interface I",id:"about-interface-i",level:3},{value:"About Interface II",id:"about-interface-ii",level:3},{value:"XIAO ESP32C3 Getting SenseCAP AI Answer",id:"xiao-esp32c3-getting-sensecap-ai-answer",level:2},{value:"Step 6. Create API Access",id:"step-6-create-api-access",level:3},{value:"Step 7. Write and upload programs",id:"step-7-write-and-upload-programs",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Q1: Why am I getting null results after getting AI answers?",id:"q1-why-am-i-getting-null-results-after-getting-ai-answers",level:3},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],c={toc:d},g="wrapper";function p(e){let{components:n,...t}=e;return(0,i.yg)(g,(0,a.A)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"using-xiao-esp32c3-to-connect-to-sensecap-ai-for-planting-advice"},"Using XIAO ESP32C3 to connect to SenseCAP AI for planting advice"),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/1.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"During this time, Seeed Studio's SenseCAP platform developed and released new AI features. Currently the main features of SenseCAP AI are focused on providing constructive planting advice to growers, and will be updated with richer AI features in the near future!"),(0,i.yg)("p",null,"This tutorial, then, will bridge the XIAO ESP32 series with the SenseCAP platform, detailing how to use the XIAO and Grove series sensors to upload data to SenseCAP and get constructive suggestions from the AI based on these sensor values."),(0,i.yg)("h2",{id:"getting-started"},"Getting Started"),(0,i.yg)("h3",{id:"hardware-preparation"},"Hardware Preparation"),(0,i.yg)("p",null,"The three pieces of hardware that will be used in this tutorial are the XIAO ESP32C3, the Grove Base for XIAO, and the Grove SHT40 temperature and humidity sensor. For the convenience of wiring, we use the XIAO expansion board, which you can purchase according to your actual needs."),(0,i.yg)("div",{class:"table-center"},(0,i.yg)("table",{align:"center"},(0,i.yg)("tr",null,(0,i.yg)("th",null,"Seeed Studio XIAO ESP32C3"),(0,i.yg)("th",null,"Grove Base for XIAO"),(0,i.yg)("th",null,"Grove - Temperature & Humidity Sensor(SHT40)")),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/XIAO_WiFi/board-pic.png",style:{width:100,height:"auto"}}))),(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/Grove-Shield-for-Seeeduino-XIAO/img/xiao_-Preview-25.png",style:{width:230,height:"auto"}}))),(0,i.yg)("td",null,(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/Wio-Terminal-Developer-for-helium/SHT40.jpg",style:{width:200,height:"auto"}})))),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Seeed-XIAO-ESP32C3-p-5431.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Grove-Shield-for-Seeeduino-XIAO-p-4621.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,i.yg)("td",null,(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Grove-Temp-Humi-Sensor-SHT40-p-5384.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f"))))))))),(0,i.yg)("h3",{id:"software-preparation"},"Software Preparation"),(0,i.yg)("p",null,"If this is your first time using the XIAO ESP32C3, then you can need to read this Wiki first to learn to configure a good development environment in Arduino."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/XIAO_ESP32C3_Getting_Started/#software-setup"},"Getting Started with Seeed Studio XIAO ESP32C3"))),(0,i.yg)("p",null,"Also, this tutorial is compatible with ",(0,i.yg)("a",{parentName:"p",href:"https://www.seeedstudio.com/XIAO-ESP32S3-p-5627.html"},"XIAO ESP32S3"),", you can also use XIAO ESP32S3 to complete the content of this tutorial."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/xiao_esp32s3_getting_started/#software-preparation"},"Getting Started with Seeed Studio XIAO ESP32S3"))),(0,i.yg)("p",null,"Since the SHT40 sensor is used, you also need to add the following two libraries well in Arduino to ensure that the program can run smoothly."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://github.com/Sensirion/arduino-i2c-sht4x"},"arduino-i2c-sht4x"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://github.com/Sensirion/arduino-core"},"Sensirion Arduino Core Library")))),(0,i.yg)("h2",{id:"xiao-esp32c3-getting-temperature-and-humidity-data"},"XIAO ESP32C3 Getting Temperature and Humidity Data"),(0,i.yg)("p",null,"As shown in the figure below, please connect the Grove SHT40 temperature and humidity sensor to the IIC interface of the XIAO."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/2.jpg",style:{width:700,height:"auto"}})),(0,i.yg)("p",null,"Then upload the following program for the XIAO ESP32C3 to drive the SHT40 sensor to work and start getting the temperature and humidity values in the air."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-cpp"},'#include <Arduino.h>\n#include <SensirionI2CSht4x.h>\n#include <Wire.h>\n\nSensirionI2CSht4x sht4x;\n\nvoid setup() {\n\n    Serial.begin(115200);\n    while (!Serial) {\n        delay(100);\n    }\n\n    Wire.begin();\n\n    uint16_t error;\n    char errorMessage[256];\n\n    sht4x.begin(Wire);\n\n    uint32_t serialNumber;\n    error = sht4x.serialNumber(serialNumber);\n    if (error) {\n        Serial.print("Error trying to execute serialNumber(): ");\n        errorToString(error, errorMessage, 256);\n        Serial.println(errorMessage);\n    } else {\n        Serial.print("Serial Number: ");\n        Serial.println(serialNumber);\n    }\n}\n\nvoid loop() {\n    uint16_t error;\n    char errorMessage[256];\n\n    delay(1000);\n\n    float temperature;\n    float humidity;\n    error = sht4x.measureHighPrecision(temperature, humidity);\n    if (error) {\n        Serial.print("Error trying to execute measureHighPrecision(): ");\n        errorToString(error, errorMessage, 256);\n        Serial.println(errorMessage);\n    } else {\n        Serial.print("Temperature:");\n        Serial.print(temperature);\n        Serial.print("\\t");\n        Serial.print("Humidity:");\n        Serial.println(humidity);\n    }\n}\n')),(0,i.yg)("p",null,"Open the serial monitor of Arduino IDE and select the baud rate as 115200 and observe the result."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/Wio-Terminal-Developer-for-helium/166.png",style:{width:700,height:"auto"}})),(0,i.yg)("h2",{id:"introduction-to-sensecap-https-api----upload-sensor-data"},"Introduction to SenseCAP HTTPS API -- Upload Sensor Data"),(0,i.yg)("p",null,"Now that we know how to get data from the SHT40 sensor, let's start by learning the following API call rules for the SenseCAP platform. You can read about using the SenseCAP API by clicking the button below to jump directly to the SenseCAP Documentation Center."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://sensecap-docs.seeed.cc/httpapi_quickstart.html"},"SenseCAP Document Center"))),(0,i.yg)("p",null,"The basic principle of SenseCAP to receive sensor data is to use EUI, Key as the authentication information and report the device data by POST."),(0,i.yg)("p",null,"HTTPS Server Address: "),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"https://sensecap.seeed.cc/deviceapi\n")),(0,i.yg)("h3",{id:"about-header"},"About Header"),(0,i.yg)("p",null,"In POST, you need to add the authentication information in the Header, which is the base64 encrypted data of the device's ",(0,i.yg)("strong",{parentName:"p"},"EUI")," and ",(0,i.yg)("strong",{parentName:"p"},"Key")," in the following basic format."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"authorization = Device base64(EUI:Key)\n")),(0,i.yg)("h3",{id:"about-interface"},"About Interface"),(0,i.yg)("p",null,"The server path to be used by the device to report sensor data is: ",(0,i.yg)("inlineCode",{parentName:"p"},"/kit/message_uplink"),", the mode is ",(0,i.yg)("strong",{parentName:"p"},"POST"),", and the following request parameters are available and allowed."),(0,i.yg)("table",{align:"center"},(0,i.yg)("tr",null,(0,i.yg)("th",null,"Name"),(0,i.yg)("th",null,"Type"),(0,i.yg)("th",null,"Description")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- requestId"),(0,i.yg)("td",{align:"center"},"string"),(0,i.yg)("td",{align:"center"},"The uuidv4 is generated on the device side each time data is reported, ensuring that the value is different for each message.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- timestamp"),(0,i.yg)("td",{align:"center"},"string"),(0,i.yg)("td",{align:"center"},"Millisecond timestamp when the message was sent.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- intent"),(0,i.yg)("td",{align:"center"},"string"),(0,i.yg)("td",{align:"center"},'Currently fixed to "event".')),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- deviceEui"),(0,i.yg)("td",{align:"center"},"string"),(0,i.yg)("td",{align:"center"},"Device EUI.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- deviceKey"),(0,i.yg)("td",{align:"center"},"string"),(0,i.yg)("td",{align:"center"},"Device Key.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- events"),(0,i.yg)("td",{align:"center"},"[object]"),(0,i.yg)("td",{align:"center"},"An array of events where data collection and device status is reported.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"-- name"),(0,i.yg)("td",{align:"center"},"string"),(0,i.yg)("td",{align:"center"},"Event Name.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"-- value"),(0,i.yg)("td",{align:"center"},"[object]"),(0,i.yg)("td",{align:"center"},"Event Value.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"-- timestamp"),(0,i.yg)("td",{align:"center"},"string"),(0,i.yg)("td",{align:"center"},"Millisecond timestamp at the time of data collection."))),(0,i.yg)("p",null,"The following is an example of sending sensor upload data."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n    "requestId": "aaaa-aaaa-aaaa-aaaa",\n    "timestamp": "1691026791405",\n    "intent": "event",\n    "deviceEui": "2CF7xxxxxxx00002",\n    "deviceKey": "38xxxxxxxxxxxxxxxxxxxxC0EE76C3CD",\n    "events": [\n        {\n            "name": "measure-sensor",\n            "value": [\n                {\n                    "channel": "1",\n                    "measurements": {\n                        "4097": "31.38",\n                        "4098": "59.60"\n                    },\n                    "measureTime": "1691026791405"\n                }\n            ]\n        },\n        {\n            "name": "update-channel-info",\n            "value": [\n                {\n                    "channel": "1",\n                    "sensorType": "1001",\n                    "status": "normal"\n                }\n            ],\n            "timestamp": "1691026791405"\n        }\n    ]\n}\n')),(0,i.yg)("h2",{id:"upload-temperature-and-humidity-data-to-sensecap"},"Upload temperature and humidity data to SenseCAP"),(0,i.yg)("p",null,"Once we understand the above rules, we can start writing the HTTPS program to upload the temperature and humidity data of our SHT40 for SenseCAP."),(0,i.yg)("h3",{id:"step-1-register-and-login-to-sensecap"},"Step 1. Register and login to SenseCAP"),(0,i.yg)("p",null,"You can click on the link below to go directly to the SenseCAP International site. If this is your first time using SenseCAP's services, you may need to register for an account."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://sensecap.seeed.cc"},"SenseCAP Website"))),(0,i.yg)("p",null,"Logging in to SenseCAP takes you to the console screen. We need to add a kit of our own, please click ",(0,i.yg)("strong",{parentName:"p"},"DevelopKit")," on the left menu bar."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/3.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Then click ",(0,i.yg)("strong",{parentName:"p"},"Create DevelopKit")," in the upper left."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/4.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Then just select the ",(0,i.yg)("strong",{parentName:"p"},"MIG Develop Kit")," and click the ",(0,i.yg)("strong",{parentName:"p"},"Confirm")," button."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/5.png",style:{width:500,height:"auto"}})),(0,i.yg)("p",null,'Next, you\'ll be able to see the device you created in the dashboard, usually the first one. Clicking on the "Connect" button for that device will display the ',(0,i.yg)("strong",{parentName:"p"},"EUI")," and ",(0,i.yg)("strong",{parentName:"p"},"KEY")," information for that device. Please save them, we will use them in the next steps."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/6.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("h3",{id:"step-2-obtaining-forensic-information"},"Step 2. Obtaining Forensic Information"),(0,i.yg)("p",null,"SenseCAP's interface for authentication information requires Base64-based ",(0,i.yg)("strong",{parentName:"p"},"EUI:KEY")," encryption."),(0,i.yg)("p",null,"For example, your EUI is ",(0,i.yg)("inlineCode",{parentName:"p"},"2CF7F11003900000")," and Key is ",(0,i.yg)("inlineCode",{parentName:"p"},"06C42483D7155E7006C42483D7155E70"),". then you can get the Base64 encrypted forensic information by the following commands in the terminal."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"echo -n 2CF7F11003900000:06C42483D7155E7006C42483D7155E70 |base64\n\n>>> MkNGN0YxMTAwMzkwMDAwMDowNkM0MjQ4M0Q3MTU1RTcwMDZDNDI0ODNENzE1NUU3MA==\n")),(0,i.yg)("p",null,"Please keep the authentication information, we will use it as the ",(0,i.yg)("strong",{parentName:"p"},"apiKey")," in the program later."),(0,i.yg)("h3",{id:"step-3-obtaining-the-number-of-the-sensor-type"},"Step 3. Obtaining the number of the sensor type"),(0,i.yg)("p",null,"Included in the upload is the number of the sensor type and sensor name that we are reporting. This is so that SenseCAP knows what sensor we are uploading data from and what units the data is in."),(0,i.yg)("p",null,"For this section, please refer to the numbered cross-reference table of sensors and values provided in the SenseCAP Documentation Center."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://sensecap-docs.seeed.cc/measurement_list.html"},"List of Measurement IDs"))),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},(0,i.yg)("a",{parentName:"p",href:"https://sensecap-docs.seeed.cc/sensor_types_list.html"},"List of Sensor Types")))),(0,i.yg)("p",null,"How to use these two documents, we will use the SHT40 sensor used in this article as an example, to give you an introduction to explain. The SHT40 sensor is a sensor that can measure both temperature and humidity data. So he has a code for the sensor type and two codes for the (temperature, humidity) values."),(0,i.yg)("p",null,"The code for a sensor type we need to look up in ",(0,i.yg)("a",{parentName:"p",href:"https://sensecap-docs.seeed.cc/sensor_types_list.html"},"List of Sensor Types"),". We found a temperature and humidity sensor with the code ",(0,i.yg)("strong",{parentName:"p"},"1001"),"."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/7.png",style:{width:700,height:"auto"}})),(0,i.yg)("p",null,"The codes for the sensor values we're talking about are actually the Measurement IDs in the diagram, ",(0,i.yg)("strong",{parentName:"p"},"4097")," and ",(0,i.yg)("strong",{parentName:"p"},"4098"),". you can also find them in the ",(0,i.yg)("a",{parentName:"p",href:"https://sensecap-docs.seeed.cc/measurement_list.html"},"List of Measurement IDs")," and check to see if the units of these values match your sensor."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/8.png",style:{width:700,height:"auto"}})),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"If you can't find the right type of sensor for you in the table. You may need to use a custom type with a sensor number of ",(0,i.yg)("strong",{parentName:"p"},"4165")," to ",(0,i.yg)("strong",{parentName:"p"},"4174"),". the sensor value may be unitless.")),(0,i.yg)("h3",{id:"step-4-install-the-necessary-libraries"},"Step 4. Install the necessary libraries"),(0,i.yg)("p",null,"First is the ",(0,i.yg)("strong",{parentName:"p"},"NTPClient")," library, which can use XIAO networking to get the current timestamp."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/9.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Next is the ",(0,i.yg)("strong",{parentName:"p"},"ArduinoJson")," library, which makes it easier to help us parse what SenseCAP returns to us."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/10.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("h3",{id:"step-5-uploading-sensor-data-through-the-program"},"Step 5. Uploading sensor data through the program"),(0,i.yg)("p",null,"The following is the procedure for uploading SHT40 data. Please note that the following macro definitions should only be used if they are modified to suit your situation."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-cpp"},'const char* ssid = "YOUR-WIFI-NAME";\nconst char* password = "YOUR-WIFI-PASSWORD";\nconst char* apiKey = "YOUR-DEVICE-EUI&KEY-BASE64";\nconst char* deviceEUI = "YOUR-DEVICE-EUI";\nconst char* deviceKey = "YOUR-DEVICE-KEY";\nconst char* dataNum_1 = "4097";  // Air temperature\nconst char* dataNum_2 = "4098";  // Air humidity\nconst char* sensorType = "1001"; // Air temperature and humidity sensors\n')),(0,i.yg)("p",null,"Where ssid and password refer to your network name and password. apiKey refers to the forensic information we obtained in ",(0,i.yg)("strong",{parentName:"p"},"Step 2"),". deviceEUI and deviceKey are your device EUI and Key, which were also obtained in ",(0,i.yg)("strong",{parentName:"p"},"Step 2"),"."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-cpp"},'#include <Arduino.h>\n#include <SensirionI2CSht4x.h>\n#include <Wire.h>\n#include "WiFi.h"\n#include <HTTPClient.h>\n#include <ArduinoJson.h>\n#include <WiFiUdp.h>\n#include <NTPClient.h>\n\n// Replace with your devive content\nconst char* ssid = "YOUR-WIFI-NAME";\nconst char* password = "YOUR-WIFI-PASSWORD";\nconst char* apiKey = "YOUR-DEVICE-EUI&KEY-BASE64";\nconst char* deviceEUI = "YOUR-DEVICE-EUI";\nconst char* deviceKey = "YOUR-DEVICE-KEY";\nconst char* dataNum_1 = "4097";  // Air temperature\nconst char* dataNum_2 = "4098";  // Air humidity\nconst char* sensorType = "1001"; // Air temperature and humidity sensors\n\nconst char* ntpServer = "pool.ntp.org";\n\nWiFiUDP ntpUDP;\nNTPClient timeClient(ntpUDP, ntpServer);\n\nchar sensecapServer[] = "https://sensecap.seeed.cc/deviceapi/kit/message_uplink";\n\nSensirionI2CSht4x sht4x;\n\nvoid wifiConnect(){\n  WiFi.begin(ssid, password);\n  Serial.print("Connecting to ");\n  Serial.println(ssid);\n  while(WiFi.status() != WL_CONNECTED) {\n    delay(500);\n    Serial.print(".");\n  }\n  Serial.println();\n  Serial.println("WiFi connected!");\n  Serial.println(WiFi.localIP());\n}\n\nvoid setup() {\n    Serial.begin(115200);\n    while (!Serial) {\n        delay(100);\n    }\n\n    Wire.begin();\n\n    uint16_t error;\n    char errorMessage[256];\n\n    sht4x.begin(Wire);\n\n    uint32_t serialNumber;\n    error = sht4x.serialNumber(serialNumber);\n    if (error) {\n        Serial.print("Error trying to execute serialNumber(): ");\n        errorToString(error, errorMessage, 256);\n        Serial.println(errorMessage);\n    } else {\n        Serial.print("Serial Number: ");\n        Serial.println(serialNumber);\n    }\n\n    wifiConnect();\n\n    timeClient.begin();  // Initialize the NTP client\n    timeClient.update(); // update timestamp\n}\n\nvoid loop() {\n    uint16_t error;\n    char errorMessage[256];\n\n    delay(1000);\n\n    float temperature;\n    float humidity;\n    error = sht4x.measureHighPrecision(temperature, humidity);\n    if (error) {\n        Serial.print("Error trying to execute measureHighPrecision(): ");\n        errorToString(error, errorMessage, 256);\n        Serial.println(errorMessage);\n    } else {\n        Serial.print("Temperature:");\n        Serial.print(temperature);\n        Serial.print("\\t");\n        Serial.print("Humidity:");\n        Serial.println(humidity);\n    }\n\n    HTTPClient https;\n    if (https.begin(sensecapServer)) {  // HTTPS\n      https.addHeader("Content-Type", "application/json"); \n      String author = String("Device ") + apiKey;\n      https.addHeader("authorization", author);\n      String payload = String("{\\"requestId\\": \\"aaaa-aaaa-aaaa-aaaa\\", \\"timestamp\\": \\"");\n      timeClient.update(); // update timestamp\n      uint64_t timestamp = timeClient.getEpochTime() * 1000ULL; // GET timestamp\n      payload += String(timestamp);\n      payload += String("\\", \\"intent\\": \\"event\\", \\"deviceEui\\": \\"");\n      payload += deviceEUI;\n      payload += String("\\", \\"deviceKey\\": \\"");\n      payload += deviceKey;\n      payload += String("\\", \\"events\\": [{\\"name\\": \\"measure-sensor\\", \\"value\\": [{\\"channel\\": \\"1\\", \\"measurements\\": {\\"");\n      payload += dataNum_1;\n      payload += String("\\": \\"");\n      payload += String(temperature);\n      payload += String("\\", \\"");\n      payload += dataNum_2;\n      payload += String("\\": \\"");\n      payload += String(humidity);\n      payload += String("\\"}, \\"measureTime\\": \\"");\n      payload += String(timestamp);\n      payload += String("\\"}]}, {\\"name\\": \\"update-channel-info\\", \\"value\\": [{\\"channel\\": \\"1\\", \\"sensorType\\": \\"");\n      payload += sensorType;\n      payload += String("\\", \\"status\\": \\"normal\\"}], \\"timestamp\\": \\"");\n      payload += String(timestamp);\n      payload += String("\\"}]}");\n      Serial.println(payload);\n      int httpCode = https.POST(payload);   // start connection and send HTTP header\n      if (httpCode == HTTP_CODE_OK || httpCode == HTTP_CODE_MOVED_PERMANENTLY) {\n        String payload = https.getString();\n        Serial.println(payload);\n      }\n      else{\n        Serial.print("[HTTP] ERROR: ");\n        Serial.println(httpCode);\n      }\n    }\n    else{\n      Serial.println("[HTTPS] Unable to connect");\n      delay(1000);\n    }\n    delay(300000);\n}\n')),(0,i.yg)("p",null,"Turn on the serial monitor, when you turn it on, the program will start to execute, when you receive the response as shown in the figure, it means that SenseCAP has successfully received one of your data uploads."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/11.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("admonition",{type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"The minimum time interval for SenseCAP to receive data uploads is five minutes.")),(0,i.yg)("h2",{id:"introduction-to-sensecap-https-api----getting-ai-advice"},"Introduction to SenseCAP HTTPS API -- Getting AI Advice"),(0,i.yg)("p",null,"Next, let's learn how to use the SenseCAP AI API below. Use our sensor data over time as a reference to get suggestions from the AI."),(0,i.yg)("p",null,"The interface call process for SenseCAP AI is roughly as follows."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Obtain the device and measurement value IDs under the account that are supported for use in AIGC via the interface I."),(0,i.yg)("li",{parentName:"ul"},"Using the result obtained by interface I as one of the parameters, interface II is called to obtain the AIGC result.",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"Since the AIGC generation time may be long, the interface I will return a ",(0,i.yg)("strong",{parentName:"li"},"resource_id")," when it is called for the first time, and then the front-end will use the ",(0,i.yg)("strong",{parentName:"li"},"resource_id")," to poll for the result of the response. When the code of the response is ",(0,i.yg)("strong",{parentName:"li"},"11338"),", it means that the AIGC is still in the process of inference, and the interface II needs to be called again with the ",(0,i.yg)("strong",{parentName:"li"},"resource_id")," until the final result is returned."),(0,i.yg)("li",{parentName:"ul"},"Interface II has a flow limit of up to ten requests within five minutes for the same account.")))),(0,i.yg)("p",null,"HTTPS Server Address:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"https://sensecap.seeed.cc/openapi\n")),(0,i.yg)("h3",{id:"about-interface-i"},"About Interface I"),(0,i.yg)("p",null,"The server path to be used by the device to report sensor data is: ",(0,i.yg)("inlineCode",{parentName:"p"},"/ai/view_suggestion_by_measurements"),", the mode is ",(0,i.yg)("strong",{parentName:"p"},"POST"),", and the following request parameters are available and allowed."),(0,i.yg)("table",{align:"center"},(0,i.yg)("tr",null,(0,i.yg)("th",null,"Name"),(0,i.yg)("th",null,"Description"),(0,i.yg)("th",null,"Note")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- lang"),(0,i.yg)("td",{align:"center"},"Select language"),(0,i.yg)("td",{align:"center"},"1:Chinese, 2:English. Default Chinese.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- location"),(0,i.yg)("td",{align:"center"},"Location"),(0,i.yg)("td",{align:"center"},'Location, e.g. "Shenzhen".')),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- crop"),(0,i.yg)("td",{align:"center"},"Crop or animal"),(0,i.yg)("td",{align:"center"},'Crop or animal to be consulted, e.g. "apple".')),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- time_range"),(0,i.yg)("td",{align:"center"},"Device data inquiry time"),(0,i.yg)("td",{align:"center"},"1: 30 days 2: 180 days 3: 360 days. Default 30 days")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- measurements"),(0,i.yg)("td",{align:"center"},"Device measurement types"),(0,i.yg)("td",{align:"center"},"Up to six")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"-- dev_eui"),(0,i.yg)("td",{align:"center"},"Device EUI"),(0,i.yg)("td",{align:"center"})),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"-- channel_measurement"),(0,i.yg)("td",{align:"center"}),(0,i.yg)("td",{align:"center"})),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"--- channel_index"),(0,i.yg)("td",{align:"center"},"Channel number"),(0,i.yg)("td",{align:"center"},"This value is currently fixed at 1.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"--- measurement_ids"),(0,i.yg)("td",{align:"center"},"Measurement value number"),(0,i.yg)("td",{align:"center"}))),(0,i.yg)("p",null,"The following is an example of calling the Interface I."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "lang": "2",\n  "crop": "apple",\n  "location": "Shenzhen",\n  "time_range": "1",\n  "measurements": [\n  {\n      "dev_eui": "2CF7F18215100010",\n      "channel_measurement": [\n        {\n          "channel_index": "1",\n          "measurement_ids": [\n            "4097",\n            "4098"\n          ]\n        }\n      ]\n    },\n    {\n      "dev_eui": "2CF7F1C043400103",\n      "channel_measurement": [\n        {\n          "channel_index": "1",\n          "measurement_ids": [\n            "4097"\n          ]\n        }\n      ]\n    }\n  ]\n}\n')),(0,i.yg)("h3",{id:"about-interface-ii"},"About Interface II"),(0,i.yg)("p",null,"The structure and framework of Interface I is largely the same as Interface II, with the only difference being the addition of an extra ",(0,i.yg)("strong",{parentName:"p"},"resource_id")," at the end. The following request parameters are available and allowed."),(0,i.yg)("table",{align:"center"},(0,i.yg)("tr",null,(0,i.yg)("th",null,"Name"),(0,i.yg)("th",null,"Description"),(0,i.yg)("th",null,"Note")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- lang"),(0,i.yg)("td",{align:"center"},"Select language"),(0,i.yg)("td",{align:"center"},"1:Chinese, 2:English. Default Chinese.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- location"),(0,i.yg)("td",{align:"center"},"Location"),(0,i.yg)("td",{align:"center"},'Location, e.g. "Shenzhen".')),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- crop"),(0,i.yg)("td",{align:"center"},"Crop or animal"),(0,i.yg)("td",{align:"center"},'Crop or animal to be consulted, e.g. "apple".')),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- time_range"),(0,i.yg)("td",{align:"center"},"Device data inquiry time"),(0,i.yg)("td",{align:"center"},"1: 30 days 2: 180 days 3: 360 days. Default 30 days")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- measurements"),(0,i.yg)("td",{align:"center"},"Device measurement types"),(0,i.yg)("td",{align:"center"},"Up to six")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"-- dev_eui"),(0,i.yg)("td",{align:"center"},"Device EUI"),(0,i.yg)("td",{align:"center"})),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"-- channel_measurement"),(0,i.yg)("td",{align:"center"}),(0,i.yg)("td",{align:"center"})),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"--- channel_index"),(0,i.yg)("td",{align:"center"},"Channel number"),(0,i.yg)("td",{align:"center"},"This value is currently fixed at 1.")),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"--- measurement_ids"),(0,i.yg)("td",{align:"center"},"Measurement value number"),(0,i.yg)("td",{align:"center"})),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},"- resource_id"),(0,i.yg)("td",{align:"center"},"Cached Credentials"),(0,i.yg)("td",{align:"center"},"In the case where a question has been asked and the returned result is obtained, carry this parameter to poll the backend until the result of the AI is returned."))),(0,i.yg)("p",null,"The following is an example of getting AI advice."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "lang": "2",\n  "crop": "apple",\n  "location": "Shenzhen",\n  "time_range": "1",\n  "measurements": [\n  {\n      "dev_eui": "2CF7F18215100010",\n      "channel_measurement": [\n        {\n          "channel_index": "1",\n          "measurement_ids": [\n            "4097",\n            "4098"\n          ]\n        }\n      ]\n    },\n    {\n      "dev_eui": "2CF7F1C043400103",\n      "channel_measurement": [\n        {\n          "channel_index": "1",\n          "measurement_ids": [\n            "4097"\n          ]\n        }\n      ]\n    }\n  ],\n  "resource_id": "openAi:ask:424326279298784:1691053698953"\n}\n')),(0,i.yg)("h2",{id:"xiao-esp32c3-getting-sensecap-ai-answer"},"XIAO ESP32C3 Getting SenseCAP AI Answer"),(0,i.yg)("h3",{id:"step-6-create-api-access"},"Step 6. Create API Access"),(0,i.yg)("p",null,"If you want to call the AIGC interface of SenseCAP, then you need to prepare the API ID and API Access Key in SenseCAP. Select ",(0,i.yg)("strong",{parentName:"p"},"Access API keys")," in the left menu bar of the dashboard. Then click ",(0,i.yg)("strong",{parentName:"p"},"Create Access Key")," at the top."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/12.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("p",null,"Copy the created ",(0,i.yg)("strong",{parentName:"p"},"Access Key ID")," and ",(0,i.yg)("strong",{parentName:"p"},"Access API Key"),". Please keep them safe and we will use them in the following steps."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/13.png",style:{width:1e3,height:"auto"}})),(0,i.yg)("h3",{id:"step-7-write-and-upload-programs"},"Step 7. Write and upload programs"),(0,i.yg)("p",null,"Following the interface guidelines above, we can then write a program that allows SenseCAP to use the temperature and humidity data from our SHT40 to return planting recommendations to us."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-cpp"},'#include <Arduino.h>\n#include <Wire.h>\n#include "WiFi.h"\n#include <HTTPClient.h>\n#include <base64.h>\n#include <ArduinoJson.h>\n\n//#define DEBUG 1\n\n// Replace with your devive content\nconst char* ssid = "YOUR-WIFI-NAME";\nconst char* password = "YOUR-WIFI-PASSWORD";\nconst char* username = "YOUR-API-ID";\nconst char* accesskey = "YOUR-ACCESS-API-KEY";\nconst char* deviceEUI = "YOUR-DEVICE-EUI";\n\nconst char* crop = "apple";\nconst char* location = "Shenzhen";\nconst char* timerange = "1";\nconst char* dataNum_1 = "4097";  //Air temperature\nconst char* dataNum_2 = "4098";  //Air humidity\n\nchar sensecapAIServer[] = "https://sensecap.seeed.cc/openapi/ai/view_suggestion_by_measurements";\n\nvoid wifiConnect(){\n  WiFi.begin(ssid, password);\n  Serial.print("Connecting to ");\n  Serial.println(ssid);\n  while(WiFi.status() != WL_CONNECTED) {\n    delay(500);\n    Serial.print(".");\n  }\n  Serial.println();\n  Serial.println("WiFi connected!");\n  Serial.println(WiFi.localIP());\n}\n\nvoid setup() {\n  // put your setup code here, to run once:\n  Serial.begin(115200);\n  while (!Serial) {\n      delay(100);\n  }\n  wifiConnect();\n}\n\nString splicePayload(int mode, String resource_id = ""){\n  String payload = String("{\\"lang\\": \\"2\\", \\"crop\\": \\"");  // 1:Chinese 2:English\n  payload += crop;\n  payload += String("\\", \\"location\\": \\"");\n  payload += location;\n  payload += String("\\", \\"time_range\\": \\"");                    // 1:30 days, 2:180 days, 3:360 days\n  payload += timerange;\n  payload += String("\\", \\"measurements\\": [{\\"dev_eui\\": \\"");\n  payload += deviceEUI;\n  payload += String("\\", \\"channel_measurement\\": [{\\"channel_index\\": \\"1\\", \\"measurement_ids\\": [\\"");\n  payload += dataNum_1;\n  payload += String("\\", \\"");\n  payload += dataNum_2;\n  payload += String("\\"]}]}");\n  \n  //If you need values for other sensors\n//    payload += String(", {\\"dev_eui\\": \\"");\n//    payload += deviceEUI_2;\n//    payload += String("\\", \\"channel_measurement\\": [{\\"channel_index\\": \\"1\\", \\"measurement_ids\\": [\\"");\n//    payload += dataNum_3;\n//    payload += String("\\"]}]}");\n\n  if(mode == 1){\n    payload += String("]}");\n  }\n  else if(mode == 2){\n    // If a query code has been obtained. mode = 2\n    payload += String("], \\"resource_id\\": \\"");\n    payload += resource_id;\n    payload += String("\\"}");\n  }\n  \n  Serial.println(payload);\n  return payload;\n}\n\nvoid loop() {\n  // put your main code here, to run repeatedly:\n  HTTPClient https;\n  if (https.begin(sensecapAIServer)) {  // HTTPS\n    https.addHeader("Content-Type", "application/json");\n    String base64Credentials = base64::encode("YOUR-API-ID:YOUR-ACCESS-API-KEY");\n    https.addHeader("Authorization", "Basic " + base64Credentials);\n    \n    String payload = splicePayload(1);\n\n    int httpCode = https.POST(payload);   // start connection and send HTTP header\n    if (httpCode == HTTP_CODE_OK || httpCode == HTTP_CODE_MOVED_PERMANENTLY) {\n      String response = https.getString();\n#ifdef DEBUG\n      Serial.println(response);\n#endif\n      \n      // get resource_id\n      DynamicJsonDocument doc(1024);\n      deserializeJson(doc, response);\n      String resource_id = doc["data"]["resource_id"].as<String>();\n      Serial.println("resource_id: " + resource_id);\n\n      String payload = splicePayload(2, resource_id);\n\n      do{\n        delay(2000);\n        https.addHeader("Content-Type", "application/json");\n        String base64Credentials = base64::encode("YOUR-API-ID:YOUR-ACCESS-API-KEY");\n        https.addHeader("Authorization", "Basic " + base64Credentials);\n        \n        int httpCode = https.POST(payload);   // start connection and send HTTP header\n        if (httpCode == HTTP_CODE_OK || httpCode == HTTP_CODE_MOVED_PERMANENTLY) {\n          String response = https.getString();\n#ifdef DEBUG\n          Serial.println(response);\n#endif\n          \n          // Parsing JSON Responses\n          DynamicJsonDocument doc(1024);\n          deserializeJson(doc, response);\n          String code = doc["code"].as<String>();\n          Serial.println("status: " + code);\n          if(code == "0"){\n            DynamicJsonDocument doc(1024);\n            deserializeJson(doc, response);\n            String suggest = doc["data"].as<String>();\n            Serial.println("SenseCAP AI gives the following planting advice: ");\n            Serial.println(suggest);\n            break;\n          }\n          else if(code == "11396"){\n            Serial.println("Timeout. Please wait five minutes.");\n            break;\n          }\n          else Serial.println("Waiting for a reply...");\n        }\n      }while(1);\n    }\n    else{\n      Serial.print("[HTTP] ERROR: ");\n      Serial.println(httpCode);\n    }\n  }\n  else{\n    Serial.println("[HTTPS] Unable to connect");\n    delay(1000);\n  }\n  Serial.println("The next query will be in five minutes, so please do not query too often to avoid having your account restricted from use!");\n  delay(300000);\n}\n')),(0,i.yg)("p",null,"Here, there are some parameters to keep an eye on. At the beginning of the code, a macro definition ",(0,i.yg)("inlineCode",{parentName:"p"},"DEBUG")," is commented out. if this line is uncommented, then the program can be executed to print the message returned each time SenseCAP returns."),(0,i.yg)("p",null,"Below ",(0,i.yg)("inlineCode",{parentName:"p"},"DEBUG")," is the information that needs to be changed depending on your account and device. For example, if you are not growing apples and the location is not Shenzhen, then you need to change it to suit your situation."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-cpp"},'// Replace with your devive content\nconst char* ssid = "YOUR-WIFI-NAME";\nconst char* password = "YOUR-WIFI-PASSWORD";\nconst char* deviceEUI = "YOUR-DEVICE-EUI";\n\nconst char* crop = "apple";\nconst char* location = "Shenzhen";\nconst char* timerange = "1";\nconst char* dataNum_1 = "4097";  //Air temperature\nconst char* dataNum_2 = "4098";  //Air humidity\n')),(0,i.yg)("p",null,"In addition to this, there are two lines in the code that parse the Access API."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-cpp"},'String base64Credentials = base64::encode("YOUR-API-ID:YOUR-ACCESS-API-KEY");\n')),(0,i.yg)("p",null,"For example, the API ID and API Key you obtained in ",(0,i.yg)("strong",{parentName:"p"},"step 6")," are ",(0,i.yg)("inlineCode",{parentName:"p"},"N0AV094KBPH1J9PX")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"5DFA8167D23C499C86F61BDEFB901D4995B896A267054D7DAD590BF67FB9A219"),", respectively. Then this line of code you should change to:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-cpp"},'String base64Credentials = base64::encode("N0AV094KBPH1J9PX:5DFA8167D23C499C86F61BDEFB901D4995B896A267054D7DAD590BF67FB9A219");\n')),(0,i.yg)("p",null,"Upload this program and you will see the message upload and keep looping through the results of the answers returned by the AI until the results are returned."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/xiao-connect-sensecap/14.png",style:{width:700,height:"auto"}})),(0,i.yg)("p",null,"At this point, congratulations you have mastered all the knowledge and content of XIAO access SenseCAP, we very much welcome you to use our XIAO and SenseCAP to utilize more of your creativity!"),(0,i.yg)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,i.yg)("h3",{id:"q1-why-am-i-getting-null-results-after-getting-ai-answers"},"Q1: Why am I getting null results after getting AI answers?"),(0,i.yg)("p",null,"This may be due to an interface timeout, you can wait until the next query is sent before checking the results. Please note that this result can only be fetched once, after that the result is immediately erased and can no longer be queried."),(0,i.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,i.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,i.yg)("div",{class:"table-center"},(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,i.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,i.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"}))))}p.isMDXComponent=!0}}]);