"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[74584],{15680:(e,t,n)=>{n.d(t,{xA:()=>s,yg:()=>g});var a=n(96540);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=a.createContext({}),d=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=d(e.components);return a.createElement(p.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},y=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,l=e.originalType,p=e.parentName,s=r(e,["components","mdxType","originalType","parentName"]),c=d(n),y=o,g=c["".concat(p,".").concat(y)]||c[y]||m[y]||l;return n?a.createElement(g,i(i({ref:t},s),{},{components:n})):a.createElement(g,i({ref:t},s))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=n.length,i=new Array(l);i[0]=y;var r={};for(var p in t)hasOwnProperty.call(t,p)&&(r[p]=t[p]);r.originalType=e,r[c]="string"==typeof e?e:o,i[1]=r;for(var d=2;d<l;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}y.displayName="MDXCreateElement"},74105:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>d});var a=n(58168),o=(n(96540),n(15680));const l={description:"YOLOv8 from training to deployment",title:"Train and deploy the YOLOv8 object detection model",keywords:["YOLOv8","we2","object detection"],image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/ma_deploy_yolov8",last_update:{date:"04/02/2024",author:"Jack Mu"}},i="Deploy YOLOv8 object detection model",r={unversionedId:"Topics/TinyML/ModelAssistant/deploy/ma_deploy_yolov8",id:"Topics/TinyML/ModelAssistant/deploy/ma_deploy_yolov8",title:"Train and deploy the YOLOv8 object detection model",description:"YOLOv8 from training to deployment",source:"@site/docs/Topics/TinyML/ModelAssistant/deploy/ma_deploy_yolov8.md",sourceDirName:"Topics/TinyML/ModelAssistant/deploy",slug:"/ma_deploy_yolov8",permalink:"/ma_deploy_yolov8",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Topics/TinyML/ModelAssistant/deploy/ma_deploy_yolov8.md",tags:[],version:"current",lastUpdatedBy:"Jack Mu",lastUpdatedAt:1712016e3,formattedLastUpdatedAt:"Apr 2, 2024",frontMatter:{description:"YOLOv8 from training to deployment",title:"Train and deploy the YOLOv8 object detection model",keywords:["YOLOv8","we2","object detection"],image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/ma_deploy_yolov8",last_update:{date:"04/02/2024",author:"Jack Mu"}},sidebar:"ProductSidebar",previous:{title:"Train and deploy the YOLOv5 object detection model",permalink:"/ma_deploy_yolov5"},next:{title:"Training and deployment of YOLOv8 pose estimation model",permalink:"/ma_deploy_yolov8_pose"}},p={},d=[{value:"Dataset preparation",id:"dataset-preparation",level:2},{value:"Install YOLOv8 command line tool",id:"install-yolov8-command-line-tool",level:2},{value:"Train",id:"train",level:2},{value:"Export model to tflite",id:"export-model-to-tflite",level:2},{value:"Model graph optimization",id:"model-graph-optimization",level:3},{value:"Deploy",id:"deploy",level:2}],s=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.yg)("div",t)},c=s("Tabs"),m=s("TabItem"),y={toc:d},g="wrapper";function u(e){let{components:t,...n}=e;return(0,o.yg)(g,(0,a.A)({},y,n,{components:t,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"deploy-yolov8-object-detection-model"},"Deploy YOLOv8 object detection model"),(0,o.yg)("div",{style:{textAlign:"center"}},(0,o.yg)("img",{src:"https://files.seeedstudio.com/sscma/static/detection_person_yolov8.png",style:{width:600,height:"auto"}})),(0,o.yg)("p",null,"This wiki will introduce how to train the official YOLOv8 target detection model and deploy the trained model to the Grove Vision AI (V2) device or ",(0,o.yg)("inlineCode",{parentName:"p"},"XIAO ESP32S3")," devices.."),(0,o.yg)("h2",{id:"dataset-preparation"},"Dataset preparation"),(0,o.yg)("p",null,"It is recommended to use the ",(0,o.yg)("a",{parentName:"p",href:"https://universe.roboflow.com/"},"roboflow")," platform for datasets. This platform can perform data set annotation and some data enhancement strategies, and supports the export of multiple data set formats."),(0,o.yg)("h2",{id:"install-yolov8-command-line-tool"},"Install YOLOv8 command line tool"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"By default, you already have the ",(0,o.yg)("inlineCode",{parentName:"li"},"python")," environment and ",(0,o.yg)("inlineCode",{parentName:"li"},"pip")," package management tool, and python>=3.8.")),(0,o.yg)(c,{mdxType:"Tabs"},(0,o.yg)(m,{value:"pip installation",label:"pip",mdxType:"TabItem"},(0,o.yg)("p",null,"Install the ",(0,o.yg)("inlineCode",{parentName:"p"},"ultralytics")," package, or by running ",(0,o.yg)("inlineCode",{parentName:"p"},"pip install -U ultralytics"),". Please visit the Python Package Index (PyPI) to learn more about the ",(0,o.yg)("inlineCode",{parentName:"p"},"ultralytics")," package at ",(0,o.yg)("a",{parentName:"p",href:"https://pypi.org/project/ultralytics/"},"https://pypi.org/project/ultralytics/"),"](",(0,o.yg)("a",{parentName:"p",href:"https://pypi.org/project/ultralytics/"},"https://pypi.org/project/ultralytics/"),")."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"# Install using pip\npip install ultralytics\n# Chinese users can use mirror acceleration\n# pip install ultralytics -i https://pypi.tuna.tsinghua.edu.cn/simple\n"))),(0,o.yg)(m,{value:"conda installation",label:"conda",mdxType:"TabItem"},(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"Conda")," is an alternative package manager to ",(0,o.yg)("inlineCode",{parentName:"p"},"pip")," and can also be used for installation. Visit Anaconda for more details: ",(0,o.yg)("a",{parentName:"p",href:"https://anaconda.org/conda-forge/ultralytics"},"https://anaconda.org/conda-forge/ultralytics")," . The ",(0,o.yg)("inlineCode",{parentName:"p"},"Ultralytics")," feedstock repository for updating ",(0,o.yg)("inlineCode",{parentName:"p"},"conda")," packages is located at ","[https://github.com/conda-forge/ultralytics-feedstock/]","(",(0,o.yg)("a",{parentName:"p",href:"https://github.com/conda-forge/ultralytics-feedstock"},"https://github.com/conda-forge/ultralytics-feedstock")," /)."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"# Install using conda\nconda install -c conda-forge ultralytics\n"))),(0,o.yg)(m,{value:"Git installation",label:"Git",mdxType:"TabItem"},(0,o.yg)("p",null,"Clone ",(0,o.yg)("inlineCode",{parentName:"p"},"ultralytics")," If you are interested in participating in development, or wish to experiment with the latest source code, please visit the repository. After cloning, navigate to the directory and install the package in developer mode using the ",(0,o.yg)("inlineCode",{parentName:"p"},"-e")," parameter."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"# Clone the official repository\ngit clone https://github.com/ultralytics/ultralytics\n\n# Go into the cloned folder\ncd ultralytics\n\n# Install in developer mode\npip install -e .\n")))),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"Tips:")," If you are not familiar with the YOLOv8 code, it is recommended that you use pip or conda to install it."),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"You can use the version query command to test whether the ",(0,o.yg)("inlineCode",{parentName:"li"},"yolo")," command line tool is successfully installed.")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"# version query\nyolo -v\n")),(0,o.yg)("h2",{id:"train"},"Train"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"First, go to the downloaded data set folder")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Execute the following command to start training the model"))),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"yolo train detect model=yolov8n.pt data=./data.yaml imgsz=192\n")),(0,o.yg)("h2",{id:"export-model-to-tflite"},"Export model to tflite"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"After training, the model will be in the ",(0,o.yg)("inlineCode",{parentName:"li"},"runs/train/exp*/weights/")," folder. Make sure that the evaluation indicators of your model meet your needs."),(0,o.yg)("li",{parentName:"ul"},"Use the following command to export the ",(0,o.yg)("inlineCode",{parentName:"li"},"tflite")," model")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"yolo export model=${your model path}  format=tflite imgsz=192 int8\n")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"You will then see a ",(0,o.yg)("inlineCode",{parentName:"li"},"yolov8n_saved_model")," folder under the current folder, which contains the ",(0,o.yg)("inlineCode",{parentName:"li"},"yolov8n_full_integer_quant.tflite")," model file,This model file can be deployed to ",(0,o.yg)("inlineCode",{parentName:"li"},"Grove Vision AI(V2)")," or ",(0,o.yg)("inlineCode",{parentName:"li"},"XIAO ESP32S3")," devices.")),(0,o.yg)("h3",{id:"model-graph-optimization"},"Model graph optimization"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Grove Vision AI (V2) supports vela-optimized models and can also accelerate model inference. First, execute the following command to install the vela command line tool (",(0,o.yg)("inlineCode",{parentName:"li"},"XIAO ESP32S3")," device is not supported yet)")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"\npip3 install ethos-u-vela\n")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"After that, you need to ",(0,o.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/sscma/configs/vela_config.ini"},"download")," ",(0,o.yg)("inlineCode",{parentName:"li"},"vela")," related configuration file, or copy the following content into a file, which can be named ",(0,o.yg)("inlineCode",{parentName:"li"},"vela_config.ini"))),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"; file: my_vela_cfg.ini ; ----------------------------------------------------------------------------- \n; Vela configuration file ; ----------------------------------------------------------------------------- \n; System Configuration \n\n; My_Sys_Cfg \n[System_Config.My_Sys_Cfg] \ncore_clock=400e6 \naxi0_port=Sram \naxi1_port=OffChipFlash \nSram_clock_scale=1.0 \nSram_burst_length=32 \nSram_read_latency=16 \nSram_write_latency=16 \nDram_clock_scale=0.75 \nDram_burst_length=128 \nDram_read_latency=500 \nDram_write_latency=250 \nOnChipFlash_clock_scale=0.25 \nOffChipFlash_clock_scale=0.015625 \nOffChipFlash_burst_length=32 \nOffChipFlash_read_latency=64 \nOffChipFlash_write_latency=64 \n; ----------------------------------------------------------------------------- \n; Memory Mode \n; My_Mem_Mode_Parent \n[Memory_Mode.My_Mem_Mode_Parent] \nconst_mem_area=Axi1 \narena_mem_area=Axi0 \ncache_mem_area=Axi0\n")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Finally, use the following command to optimize the graph")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"vela --accelerator-config ethos-u55-64 \\ \n    --config vela_config.ini \\\n    --system-config My_Sys_Cfg \\\n    --memory-mode My_Mem_Mode_Parent \\\n    --output-dir ${Save path of the optimized model} \\\n    ${The path of the tflite model that needs to be optimized}\n")),(0,o.yg)("p",null,"After execution, a graph-optimized tflite model will be generated in the path specified by ",(0,o.yg)("inlineCode",{parentName:"p"},"--output-dir"),"."),(0,o.yg)("h2",{id:"deploy"},"Deploy"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"The model file that needs to be deployed is the ",(0,o.yg)("inlineCode",{parentName:"p"},"tflite")," file exported above. You can burn the model file to the target device according to the following tutorial.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"We strongly recommend using our web tool to burn the trained tflite model into the device. Detailed operations are provided in the ",(0,o.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/ModelAssistant_Deploy_Overview/"},"Deployment Tutorial")))),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"Note:")," Since the ",(0,o.yg)("inlineCode",{parentName:"p"},"ESP32S3")," device does not support model deployment after ",(0,o.yg)("inlineCode",{parentName:"p"},"vela")," graph optimization, you do not need to perform ",(0,o.yg)("inlineCode",{parentName:"p"},"tflite")," model graph optimization if you want to deploy the model to the ",(0,o.yg)("inlineCode",{parentName:"p"},"XIAO ESP32S3")," device."))}u.isMDXComponent=!0}}]);