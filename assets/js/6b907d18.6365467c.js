"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[89318],{15680:(e,t,n)=>{n.d(t,{xA:()=>d,yg:()=>g});var o=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=o.createContext({}),p=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return o.createElement(s.Provider,{value:t},e.children)},u="mdxType",y={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(n),h=i,g=u["".concat(s,".").concat(h)]||u[h]||y[h]||a;return n?o.createElement(g,r(r({ref:t},d),{},{components:n})):o.createElement(g,r({ref:t},d))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,r=new Array(a);r[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:i,r[1]=l;for(var p=2;p<a;p++)r[p]=n[p];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},74762:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>y,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var o=n(58168),i=(n(96540),n(15680));const a={description:"XIAO SAMD21 With Zephyr(RTOS)",title:"XIAO SAMD21 With Zephyr(RTOS)",keywords:["Sorftware"],image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/XIAO-SAMD21-Zephyr-RTOS",last_update:{date:"04/16/2023",author:"timo614"}},r="XIAO SAMD21 With Zephyr(RTOS)",l={unversionedId:"Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_SAMD21/XIAO-SAMD21-Zephyr-RTOS",id:"Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_SAMD21/XIAO-SAMD21-Zephyr-RTOS",title:"XIAO SAMD21 With Zephyr(RTOS)",description:"XIAO SAMD21 With Zephyr(RTOS)",source:"@site/docs/Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_SAMD21/XIAO-SAMD21-Zephyr-RTOS.md",sourceDirName:"Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_SAMD21",slug:"/XIAO-SAMD21-Zephyr-RTOS",permalink:"/XIAO-SAMD21-Zephyr-RTOS",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_SAMD21/XIAO-SAMD21-Zephyr-RTOS.md",tags:[],version:"current",lastUpdatedBy:"timo614",lastUpdatedAt:1681603200,formattedLastUpdatedAt:"Apr 16, 2023",frontMatter:{description:"XIAO SAMD21 With Zephyr(RTOS)",title:"XIAO SAMD21 With Zephyr(RTOS)",keywords:["Sorftware"],image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/XIAO-SAMD21-Zephyr-RTOS",last_update:{date:"04/16/2023",author:"timo614"}},sidebar:"ProductSidebar",previous:{title:"Getting Started with Seeed Studio XIAO SAMD21",permalink:"/Seeeduino-XIAO"},next:{title:"Nanase",permalink:"/Seeeduino-XIAO-by-Nanase"}},s={},p=[{value:"What is RTOS",id:"what-is-rtos",level:2},{value:"What is Zephyr",id:"what-is-zephyr",level:2},{value:"Feature",id:"feature",level:2},{value:"Extensive suite of Kernel services",id:"extensive-suite-of-kernel-services",level:3},{value:"Multiple Scheduling Algorithms",id:"multiple-scheduling-algorithms",level:3},{value:"Bluetooth Low Energy 5.0 support",id:"bluetooth-low-energy-50-support",level:3},{value:"Getting Started",id:"getting-started",level:2},{value:"Hardware Preparation",id:"hardware-preparation",level:2},{value:"Developer Knowledge",id:"developer-knowledge",level:3},{value:"XIAO Expansion Board",id:"xiao-expansion-board",level:4},{value:"Pin Definitions",id:"pin-definitions",level:4},{value:"Primary Functionality",id:"primary-functionality",level:3},{value:"Onboard LED",id:"onboard-led",level:4},{value:"USB HID",id:"usb-hid",level:4},{value:"LittleFS",id:"littlefs",level:4},{value:"TFLite - Hello World",id:"tflite---hello-world",level:4},{value:"Additional Components",id:"additional-components",level:3},{value:"Grove - Expansion Board - I2C Display",id:"grove---expansion-board---i2c-display",level:4},{value:"Grove - Expansion Board - Button",id:"grove---expansion-board---button",level:4},{value:"Grove - Expansion Board - Buzzer",id:"grove---expansion-board---buzzer",level:4},{value:"Grove - Expansion Board - SD Card",id:"grove---expansion-board---sd-card",level:4},{value:"Grove - Temperature and Humidity Sensor (SHT31)",id:"grove---temperature-and-humidity-sensor-sht31",level:4},{value:"1.69inch LCD Display Module, 240\xd7280 Resolution, SPI Interface",id:"169inch-lcd-display-module-240280-resolution-spi-interface",level:4},{value:"\u2728 Contributor Project",id:"-contributor-project",level:2},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],d={toc:p},u="wrapper";function y(e){let{components:t,...n}=e;return(0,i.yg)(u,(0,o.A)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"xiao-samd21-with-zephyrrtos"},"XIAO SAMD21 With Zephyr(RTOS)"),(0,i.yg)("div",{align:"center"},(0,i.yg)("img",{width:"{100}",src:"https://files.seeedstudio.com/wiki/xiao_topicpage/zephyr-samd21.png"})),(0,i.yg)("h2",{id:"what-is-rtos"},"What is RTOS"),(0,i.yg)("p",null,"One of the most important components of today's embedded systems is the ",(0,i.yg)("strong",{parentName:"p"},"RTOS")," also known as ",(0,i.yg)("strong",{parentName:"p"},"Real-Time Operating System"),", which is responsible for everything from task scheduling to performing applications."),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"RTOS")," is designed to provide a predictable execution mode. When the processing must meet the time limit of the system, RTOS is used. Therefore, compared with GPOS (General Purpose Operating System), RTOS is usually light in weight and small in size, and generally only provides functions required to run specific types of applications on specific hardware. In some cases, developers can modify the existing RTOS, narrow it down to only provide the functionality required by a specific application, and/or customize its functionality or performance characteristics."),(0,i.yg)("h2",{id:"what-is-zephyr"},"What is ",(0,i.yg)("a",{parentName:"h2",href:"https://www.zephyrproject.org/"},"Zephyr")),(0,i.yg)("div",{align:"center"},(0,i.yg)("img",{width:"{200}",src:"https://files.seeedstudio.com/wiki/XIAO/Zephyr_logo.png"})),(0,i.yg)("p",null,"The ",(0,i.yg)("a",{parentName:"p",href:"https://www.zephyrproject.org/"},(0,i.yg)("strong",{parentName:"a"},"Zephyr"))," OS is based on a small-footprint kernel designed for use on resource-constrained and embedded systems: from simple embedded environmental sensors and LED wearables to sophisticated embedded controllers, smart watches, and IoT wireless applications."),(0,i.yg)("h2",{id:"feature"},"Feature"),(0,i.yg)("p",null,"Zephyr offers a large and ever growing number of features including:"),(0,i.yg)("h3",{id:"extensive-suite-of-kernel-services"},"Extensive suite of Kernel services"),(0,i.yg)("p",null,"Zephyr offers a number of familiar services for development:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("em",{parentName:"li"},"Multi-threading Services")," for cooperative, priority-based, non-preemptive, and preemptive threads with optional round robin time-slicing. Includes POSIX pthreads compatible API support."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("em",{parentName:"li"},"Interrupt Services")," for compile-time registration of interrupt handlers."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("em",{parentName:"li"},"Memory Allocation Services")," for dynamic allocation and freeing of fixed-size or variable-size memory blocks."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("em",{parentName:"li"},"Inter-thread Synchronization Services")," for binary semaphores, counting semaphores, and mutex semaphores."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("em",{parentName:"li"},"Inter-thread Data Passing Services")," for basic message queues, enhanced message queues, and byte streams."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("em",{parentName:"li"},"Power Management Services")," such as overarching, application or policy-defined, System Power Management and fine-grained, driver-defined, Device Power Management.")),(0,i.yg)("h3",{id:"multiple-scheduling-algorithms"},"Multiple Scheduling Algorithms"),(0,i.yg)("p",null,"  Zephyr provides a comprehensive set of thread scheduling choices:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Cooperative and Preemptive Scheduling"),(0,i.yg)("li",{parentName:"ul"},"Earliest Deadline First (EDF)"),(0,i.yg)("li",{parentName:"ul"},"Meta IRQ scheduling implementing \u201cinterrupt bottom half\u201d or \u201ctasklet\u201d behavior"),(0,i.yg)("li",{parentName:"ul"},"Timeslicing: Enables time slicing between preemptible threads of equal priority"),(0,i.yg)("li",{parentName:"ul"},"Multiple queuing strategies:",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"Simple linked-list ready queue"),(0,i.yg)("li",{parentName:"ul"},"Red/black tree ready queue"),(0,i.yg)("li",{parentName:"ul"},"Traditional multi-queue ready queue")))),(0,i.yg)("h3",{id:"bluetooth-low-energy-50-support"},"Bluetooth Low Energy 5.0 support"),(0,i.yg)("p",null,"Bluetooth 5.0 compliant (ESR10) and Bluetooth Low Energy Controller support (LE Link Layer). Includes Bluetooth mesh and a Bluetooth qualification-ready Bluetooth controller."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Generic Access Profile (GAP) with all possible LE roles"),(0,i.yg)("li",{parentName:"ul"},"Generic Attribute Profile (GATT)"),(0,i.yg)("li",{parentName:"ul"},"Pairing support, including the Secure Connections feature from Bluetooth 4.2"),(0,i.yg)("li",{parentName:"ul"},"Clean HCI driver abstraction"),(0,i.yg)("li",{parentName:"ul"},"Raw HCI interface to run Zephyr as a Controller instead of a full Host stack"),(0,i.yg)("li",{parentName:"ul"},"Verified with multiple popular controllers"),(0,i.yg)("li",{parentName:"ul"},"Highly configurable")),(0,i.yg)("p",null,"Mesh Support:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Relay, Friend Node, Low-Power Node (LPN) and GATT Proxy features"),(0,i.yg)("li",{parentName:"ul"},"Both Provisioning bearers supported (PB-ADV & PB-GATT)"),(0,i.yg)("li",{parentName:"ul"},"Highly configurable, fitting in devices with at least 16k RAM")),(0,i.yg)("p",null,(0,i.yg)("em",{parentName:"p"},"Reference: ",(0,i.yg)("a",{parentName:"em",href:"https://docs.zephyrproject.org/latest/introduction/index.html#"},(0,i.yg)("strong",{parentName:"a"},"Zephyr Project")))),(0,i.yg)("h2",{id:"getting-started"},"Getting Started"),(0,i.yg)("p",null,"This wiki covers ",(0,i.yg)("a",{parentName:"p",href:"https://www.zephyrproject.org/"},"Zephyr")," support for the ",(0,i.yg)("a",{parentName:"p",href:"https://docs.zephyrproject.org/latest/boards/seeed/seeeduino_xiao/doc/index.html"},"XIAO SAMD21 Zephyr(RTOS) Getting Started"),". With the assistance of this guide you will be able to utilize the feature set available to the board."),(0,i.yg)("p",null,"The first step to working with Zephyr is to get the SDK and toolchain setup for local development. The ",(0,i.yg)("a",{parentName:"p",href:"https://docs.zephyrproject.org/latest/develop/getting_started/index.html"},"Zephyr getting started guide")," should be referenced for the associated setup procedure needed for your environment."),(0,i.yg)("p",null,"Once the Zephyr toolchain has been setup and an associated SDK has been downloaded you can begin application development."),(0,i.yg)("p",null,"To program the Xiao SAMD21 the following steps can be taken:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"Build an example or your application"),(0,i.yg)("li",{parentName:"ol"},"Plugin the Xiao SAMD21"),(0,i.yg)("li",{parentName:"ol"},"Short the RST pin to GND (using the visible test points) to boot the MCU into bootloader mode (or press the RESET button on an attached expansion board twice in a row quickly)"),(0,i.yg)("li",{parentName:"ol"},"Proceed to use ",(0,i.yg)("inlineCode",{parentName:"li"},"west flash")," to flash your firmware to the board")),(0,i.yg)("p",null,'The simplest example is to run the "Hello World" sample on the board. After changing to the directory of the Zephyr install run the following commands.'),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west build -p always -b seeeduino_xiao samples/subsys/usb/console\n")),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"Find the port for your device by typing ",(0,i.yg)("inlineCode",{parentName:"p"},"ls /dev/tty*")," and confirming which device appears when your USB has been plugged in."),(0,i.yg)("p",null,"In my example I see ",(0,i.yg)("inlineCode",{parentName:"p"},"/dev/ttyACM0")," as the newly added device."),(0,i.yg)("p",null,"Using screen you can then connect and monitor the serial response:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"screen /dev/ttyACM0 115200\n")),(0,i.yg)("p",null,"You should see a response similar to the following:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"*** Booting Zephyr OS build v3.6.0-2566-gc9b45bf4672a ***\nHello World! arm\nHello World! arm\nHello World! arm\nHello World! arm\n")),(0,i.yg)("p",null,"To assist with the process of using Zephyr with Xiao and its expansion board a repository has been constructed with several overlays and configurations used here. The commands included in this wiki article assume it is located ",(0,i.yg)("inlineCode",{parentName:"p"},"../applications/xiao-zephyr-examples")," relative to the zephyr root. An alternative path can be provided to the commands below by updating it."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"git clone https://github.com/Cosmic-Bee/xiao-zephyr-examples\n")),(0,i.yg)("h2",{id:"hardware-preparation"},"Hardware Preparation"),(0,i.yg)("table",{align:"center"},(0,i.yg)("tbody",null,(0,i.yg)("tr",null,(0,i.yg)("th",null,"Seeed Studio XIAO SAMD21"),(0,i.yg)("th",null,"Seeed Studio Expansion Board")),(0,i.yg)("tr",null,(0,i.yg)("td",null,(0,i.yg)("div",{align:"center"},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/Seeeduino-XIAO/img/Seeeduino-XIAO-preview-1.jpg",style:{width:300,height:"auto"}}))),(0,i.yg)("td",null,(0,i.yg)("div",{align:"center"},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/Seeeduino-XIAO-Expansion-Board/Update_pic/zheng1.jpg",style:{width:210,height:"auto"}})))),(0,i.yg)("tr",null,(0,i.yg)("td",{align:"center"},(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Seeeduino-XIAO-Arduino-Microcontroller-SAMD21-Cortex-M0+-p-4426.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,i.yg)("td",{align:"center"},(0,i.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,i.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Seeeduino-XIAO-Expansion-board-p-4746.html"},(0,i.yg)("strong",null,(0,i.yg)("span",null,(0,i.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now\ud83d\uddb1\ufe0f"))))))))),(0,i.yg)("h3",{id:"developer-knowledge"},"Developer Knowledge"),(0,i.yg)("h4",{id:"xiao-expansion-board"},"XIAO Expansion Board"),(0,i.yg)("p",null,"  In order to use Grove modules with Seeed Studio XIAO SAMD21, we will use a ",(0,i.yg)("a",{parentName:"p",href:"https://www.seeedstudio.com/Seeeduino-XIAO-Expansion-board-p-4746.html"},"Seeed Studio Expansion Base for XIAO")," and connect XIAO SAMD21 on it."),(0,i.yg)("p",null,"  After that, the Grove connectors on the board can be used to connect Grove modules"),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/wiki-ranger/Contributions/C3-ESPHome-full_function/29.png",style:{width:700,height:"auto"}})),(0,i.yg)("h4",{id:"pin-definitions"},"Pin Definitions"),(0,i.yg)("p",null,"  You need to follow the graphic below to use the appropriate internal pin numbers when connecting the Grove modules to the Grove connectors on Grove Shield for Seeed Studio XIAO."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/Seeeduino-XIAO/img/Seeeduino-XIAO-pinout-1.jpg",style:{width:900,height:"auto"}})),(0,i.yg)("h3",{id:"primary-functionality"},"Primary Functionality"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Onboard LED"),(0,i.yg)("li",{parentName:"ul"},"USB HID"),(0,i.yg)("li",{parentName:"ul"},"LittleFS"),(0,i.yg)("li",{parentName:"ul"},"TFLite")),(0,i.yg)("h4",{id:"onboard-led"},"Onboard LED"),(0,i.yg)("p",null,"For this example we'll use the blinky sample to blink the onboard LED."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/basic/blinky\n")),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"You will see the onboard yellow LED toggle on and off creating a blinking effect."),(0,i.yg)("p",null,"Let's dive into this example a bit to see why it works."),(0,i.yg)("p",null,"The associated example code reference led0:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"#define LED0_NODE DT_ALIAS(led0)\nstatic const struct gpio_dt_spec led = GPIO_DT_SPEC_GET(LED0_NODE, gpios);\n")),(0,i.yg)("p",null,"This is defined in the Xiao SAMD21 devicetree code via an alias:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'    aliases {\n        led0 = &led;\n    };\n\n    leds {\n        compatible = "gpio-leds";\n        led: led_0 {\n            gpios = <&porta 17 GPIO_ACTIVE_LOW>;\n            label = "LED";\n        };\n    };\n')),(0,i.yg)("p",null,"It corresponds with the PA17 pin on the board. This can be found via the Xiao SAMD21 schematic by looking over the MCU and seeing the labeling on the pins."),(0,i.yg)("p",null,"For the pins with the Xiao breakut you don't need to use the &porta and &portb pin mapping directly as the board files provide a Xiao connector which simplifies the interface."),(0,i.yg)("p",null,"For example if I were to reference D0 I'd reference it either as ",(0,i.yg)("inlineCode",{parentName:"p"},"&porta 2")," or ",(0,i.yg)("inlineCode",{parentName:"p"},"&xiao_d 0"),"."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'/ {\n    xiao_d: connector {\n        compatible = "seeed,xiao-gpio";\n        #gpio-cells = <2>;\n        gpio-map-mask = <0xffffffff 0xffffffc0>;\n        gpio-map-pass-thru = <0 0x3f>;\n        gpio-map\n            = <0 0 &porta 2 0>      /* D0 */\n            , <1 0 &porta 4 0>      /* D1 */\n            , <2 0 &porta 10 0>     /* D2 */\n            , <3 0 &porta 11 0>     /* D3 */\n            , <4 0 &porta 8 0>      /* D4 */\n            , <5 0 &porta 9 0>      /* D5 */\n            , <6 0 &portb 8 0>      /* D6 */\n            , <7 0 &portb 9 0>      /* D7 */\n            , <8 0 &porta 7 0>      /* D8 */\n            , <9 0 &porta 5 0>      /* D9 */\n            , <10 0 &porta 6 0>     /* D10 */\n            ;\n    };\n};\n')),(0,i.yg)("h4",{id:"usb-hid"},"USB HID"),(0,i.yg)("p",null,"For this sample application we'll use the USB HID Mouse sample to allow the Xiao SAMD21 to trigger mouse clicks for the host computer."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/subsys/usb/hid-mouse --  -DDTC_OVERLAY_FILE=/home/nineso/zephyrproject/zephyr/boards/shields/seeed_xiao_expansion_board/seeed_xiao_expansion_board.overlay\n")),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"After your Xiao resets you should now be able to control the left mouse button via the button on your expansion board. Try hovering over some text and double clicking the button quickly. You'll see the text get highlighted in a similar manner as if you were to use your normal mouse to left click. You'll also notice the onboard LED lights up when you click the button as the sample also relies on an LED being set in the devicetree."),(0,i.yg)("p",null,"Additional buttons can be configured for use with the sample as it allows for up to 4 buttons to be configured to trigger both buttons and direction for the mouse for sample purposes."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'    buttons {\n        compatible = "gpio-keys";\n        xiao_button0: button_0 {\n            gpios = <&xiao_d 1 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;\n            label = "SW0";\n            zephyr,code = <INPUT_KEY_0>;\n        };\n    };\n\n    aliases {\n        sw0 = &xiao_button0;\n    };\n')),(0,i.yg)("p",null,"You can see here from the example ",(0,i.yg)("inlineCode",{parentName:"p"},"&xiao_d")," 1 is used here to indicate the D1 pin. This mapping is provided by the Xiao SAMD21 board files and makes it conveinent for connecting to a given pin as you do not need to know the underlying MCU mapping but can rely on the Xiao pinout."),(0,i.yg)("p",null,"For the HID Mouse sample the buttons are determined by if they are ",(0,i.yg)("inlineCode",{parentName:"p"},'compatible = "gpio-keys";')," and if they have have a mapping to associated keys (0-3 for the mouse). In this case we're using ",(0,i.yg)("inlineCode",{parentName:"p"},"zephyr,code = <INPUT_KEY_0>;")," which corresponds to the left mouse button."),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"led0")," alias is set by the board's devicetree file as mentioned in the previous section."),(0,i.yg)("h4",{id:"littlefs"},"LittleFS"),(0,i.yg)("p",null,"For this example we'll use the littlefs zephyr sample to create a littlefs partition and save the file to the filesystem. Then we'll reconnect and confirm it's still there via the serial output."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/subsys/fs/littlefs -- -DDTC_OVERLAY_FILE="$(dirname $(pwd))/applications/xiao-zephyr-examples/console.overlay" -DEXTRA_CONF_FILE=$(dirname $(pwd))/applications/xiao-zephyr-examples/console.conf\n')),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"Wait a moment for the MCU to reset after flashing and connect to monitor:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"screen /dev/ttyACM0 115200\n")),(0,i.yg)("p",null,"With this loaded you should see something similar to:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"*** Booting Zephyr OS build v3.6.0-2566-gc9b45bf4672a ***\nSample program to r/w files on littlefs\nArea 2 at 0x3c000 on nvmctrl@41004000 for 16384 bytes\nI: LittleFS version 2.8, disk version 2.1\nI: FS at nvmctrl@41004000:0x3c000 is 64 0x100-byte blocks with 512 cycle\nI: sizes: rd 16 ; pr 16 ; ca 64 ; la 32\nE: WEST_TOPDIR/modules/fs/littlefs/lfs.c:1351: Corrupted dir pair at {0x0, 0x1}\nW: can't mount (LFS -84); formatting\nI: /lfs mounted\n/lfs mount: 0\n/lfs: bsize = 16 ; frsize = 256 ; blocks = 64 ; bfree = 62\n\nListing dir /lfs ...\n/lfs/boot_count read count:0 (bytes: 0)\n/lfs/boot_count write new boot count 1: [wr:1]\nI: Test file: /lfs/pattern.bin not found, create one!\n------ FILE: /lfs/pattern.bin ------\n01 55 55 55 55 55 55 55 02 55 55 55 55 55 55 55\n03 55 55 55 55 55 55 55 04 55 55 55 55 55 55 55\n05 55 55 55 55 55 55 55 06 55 55 55 55 55 55 55\n07 55 55 55 55 55 55 55 08 55 55 55 55 55 55 55\n09 55 55 55 55 55 55 55 0a 55 55 55 55 55 55 55\n0b 55 55 55 55 55 55 55 0c 55 55 55 55 55 55 55\n")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"screen /dev/ttyACM0 115200\n")),(0,i.yg)("p",null,"Now connecting again to the serial monitor we do not see the formatting nor does it need to create a file:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"*** Booting Zephyr OS build v3.6.0-2566-gc9b45bf4672a ***\nSample program to r/w files on littlefs\nArea 2 at 0x3c000 on nvmctrl@41004000 for 16384 bytes\nI: LittleFS version 2.8, disk version 2.1\nI: FS at nvmctrl@41004000:0x3c000 is 64 0x100-byte blocks with 512 cycle\nI: sizes: rd 16 ; pr 16 ; ca 64 ; la 32\n/lfs mount: 0\n/lfs: bsize = 16 ; frsize = 256 ; blocks = 64 ; bfree = 59\n\nListing dir /lfs ...\n[FILE] boot_count (size = 1)\n[FILE] pattern.bin (size = 547)\n/lfs/boot_count read count:1 (bytes: 1)\n/lfs/boot_count write new boot count 2: [wr:1]\n------ FILE: /lfs/pattern.bin ------\n02 55 55 55 55 55 55 55 03 55 55 55 55 55 55 55\n04 55 55 55 55 55 55 55 05 55 55 55 55 55 55 55\n06 55 55 55 55 55 55 55 07 55 55 55 55 55 55 55\n08 55 55 55 55 55 55 55 09 55 55 55 55 55 55 55\n0a 55 55 55 55 55 55 55 0b 55 55 55 55 55 55 55\n0c 55 55 55 55 55 55 55 0d 55 55 55 55 55 55 55\n0e 55 55 55 55 55 55 55 0f 55 55 55 55 55 55 55\n10 55 55 55 55 55 55 55 11 55 55 55 55 55 55 55\n12 55 55 55 55 55 55 55 13 55\n")),(0,i.yg)("h4",{id:"tflite---hello-world"},"TFLite - Hello World"),(0,i.yg)("p",null,"Enable TFLite with Zephyr and update:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west config manifest.project-filter -- +tflite-micro\nwest update\n")),(0,i.yg)("p",null,'For this example we\'re going to use the sample tflite "Hello World" along with our console overlay and conf to read the response over USB serial.'),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/modules/tflite-micro/hello_world -- -DDTC_OVERLAY_FILE=$(dirname $(pwd))/applications/xiao-zephyr-examples/console.overlay -DEXTRA_CONF_FILE=$(dirname $(pwd))/applications/xiao-zephyr-examples/console.conf\n")),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"Wait a moment for the MCU to reset after flashing and connect to monitor:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"screen /dev/ttyACM0 115200\n")),(0,i.yg)("p",null,"You will see results returned from the console:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"*** Booting Zephyr OS build v3.6.0-2566-gc9b45bf4672a ***\nx_value: 1.0*2^-127, y_value: 1.0*2^-127\n\nx_value: 1.2566366*2^-2, y_value: 1.4910772*2^-2\n\nx_value: 1.2566366*2^-1, y_value: 1.1183078*2^-1\n\nx_value: 1.8849551*2^-1, y_value: 1.677462*2^-1\n\nx_value: 1.2566366*2^0, y_value: 1.9316229*2^-1\n\nx_value: 1.5707957*2^0, y_value: 1.0420598*2^0\n\nx_value: 1.8849551*2^0, y_value: 1.9146791*2^-1\n\nx_value: 1.0995567*2^1, y_value: 1.6435742*2^-1\n\nx_value: 1.2566366*2^1, y_value: 1.0674761*2^-1\n\nx_value: 1.4137159*2^1, y_value: 1.8977352*2^-3\n")),(0,i.yg)("h3",{id:"additional-components"},"Additional Components"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.seeedstudio.com/Seeeduino-XIAO-Expansion-board-p-4746.html"},"Grove - Expansion Board")," - I2C Display"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.seeedstudio.com/Seeeduino-XIAO-Expansion-board-p-4746.html"},"Grove - Expansion Board")," - Button"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.seeedstudio.com/Seeeduino-XIAO-Expansion-board-p-4746.html"},"Grove - Expansion Board")," - Buzzer"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.seeedstudio.com/Seeeduino-XIAO-Expansion-board-p-4746.html"},"Grove - Expansion Board")," - SD Card"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.seeedstudio.com/Grove-Temperature-Humidity-Sensor-SHT31.html"},"Grove - Temperature and Humidity Sensor (SHT31)")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.seeedstudio.com/1-69inch-240-280-Resolution-IPS-LCD-Display-Module-p-5755.html"},"1.69inch LCD Display Module, 240\xd7280 Resolution, SPI Interface"))),(0,i.yg)("h4",{id:"grove---expansion-board---i2c-display"},"Grove - Expansion Board - I2C Display"),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/wiki-ranger/Contributions/xiao_samd21_zephyr/xiao_expansion_oled1.jpg",style:{width:600,height:"auto"}})),(0,i.yg)("p",null,"To test this setup we can use an existing sample with Zephyr:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/drivers/display -- -DSHIELD=seeed_xiao_expansion_board\n")),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"You'll see a display showing multiple black boxes and a blinking box in the corner given this display only supports two colors."),(0,i.yg)("p",null,"Let's dive into this example a bit to see why it works:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'/ {\n    chosen {\n      zephyr,display = &ssd1306;\n    };\n};\n\n&xiao_i2c {\n  status = "okay";\n\n  ssd1306: ssd1306@3c {\n    compatible = "solomon,ssd1306fb";\n    reg = <0x3c>;\n    width = <128>;\n    height = <64>;\n    segment-offset = <0>;\n    page-offset = <0>;\n    display-offset = <0>;\n    multiplex-ratio = <63>;\n    segment-remap;\n    com-invdir;\n    prechargep = <0x22>;\n  };\n')),(0,i.yg)("p",null,"The shield's overlay file in this example sets up a SSD1306 OLED screen at the 0x3C register. It is selected as the zephyr display in the chosen section."),(0,i.yg)("h4",{id:"grove---expansion-board---button"},"Grove - Expansion Board - Button"),(0,i.yg)("p",null,"To test this setup we can use an existing sample with Zephyr which we will use along with the USB console overlay and conf."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/basic/button -- -DDTC_OVERLAY_FILE="$(dirname $(pwd))/applications/xiao-zephyr-examples/console.overlay" -DEXTRA_CONF_FILE=$(dirname $(pwd))/applications/xiao-zephyr-examples/console.conf -DSHIELD=seeed_xiao_expansion_board\n')),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"Wait a moment for the MCU to reset after flashing and connect to monitor:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"screen /dev/ttyACM0 115200\n")),(0,i.yg)("p",null,"Pressing the button with the sample will trigger the onboard LED to light up."),(0,i.yg)("p",null,"You will see results returned from the console:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"*** Booting Zephyr OS build v3.6.0-2566-gc9b45bf4672a ***\nSet up button at gpio@41004400 pin 4\nSet up LED at gpio@41004400 pin 17\nPress the button\nButton pressed at 420744116\nButton pressed at 454208099\nButton pressed at 484598863\nButton pressed at 518217016\nButton pressed at 550754013\nButton pressed at 591496990\n")),(0,i.yg)("p",null,"Let's dive into this example a bit to see why it works:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'/ {\n    aliases {\n      sw0 = &xiao_button0;\n    };\n\n    buttons {\n      compatible = "gpio-keys";\n      xiao_button0: button_0 {\n        gpios = <&xiao_d 1 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;\n        label = "SW0";\n        zephyr,code = <INPUT_KEY_0>;\n      };\n    };\n};\n')),(0,i.yg)("p",null,"The app overlay file is used to setup various board components. Using this file the button example can be utilized as the overlay allows the Zephyr to configure the button and make it available for the associated code."),(0,i.yg)("p",null,"In this case it is using the &xiao_d connector interface to associate D1 as a button. Alternatively we could have used the ",(0,i.yg)("inlineCode",{parentName:"p"},"&porta")," interface here as ",(0,i.yg)("inlineCode",{parentName:"p"},"&porta 4")," which is the corresponding pin on the MCU associated with D1."),(0,i.yg)("h4",{id:"grove---expansion-board---buzzer"},"Grove - Expansion Board - Buzzer"),(0,i.yg)("p",null,"We'll activate our buzzer using the blinky PWM example to control its activation via a PWM signal. For this we'll use a custom overlay which enables the PWM for the A3 pin."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/basic/blinky_pwm -- -DDTC_OVERLAY_FILE="$(dirname $(pwd))/applications/xiao-zephyr-examples/xiao-samd21/xiao_expansion_buzzer.overlay"\n')),(0,i.yg)("p",null,"After uploading the uf2 file you should begin hearing a series of buzzes which change in sound as the sample runs its course."),(0,i.yg)("p",null,"Let's look at why this works:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'/delete-node/ &pwm_led0;\n\n/ {\n    aliases {\n        pwm-led = &pwm_led0;\n    };\n\n    pwm_leds {\n        status = "okay";\n        compatible = "pwm-leds";\n\n        pwm_led0: pwm_led_0 {\n            pwms = <&tcc1 1 PWM_HZ(880) >;\n        };\n    };\n};\n\n&pinctrl {\n    pwm_default: pwm_default {\n        group1 {\n            pinmux = <PA11E_TCC1_WO1>;\n        };\n    };\n};\n\n&tcc1 {\n    status = "okay";\n    compatible = "atmel,sam0-tcc-pwm";\n    /* Gives a maximum period of 1.4 s */\n    prescaler = <1024>;\n    #pwm-cells = <2>;\n\n    pinctrl-0 = <&pwm_default>;\n    pinctrl-names = "default";\n};\n')),(0,i.yg)("p",null,"The overlay in use first removes the existing ",(0,i.yg)("inlineCode",{parentName:"p"},"pwm_led0")," node as this board is configured with this alias already. It then configures the A3 pin for use as a PWM."),(0,i.yg)("p",null,"We're using pin A3 which corresponds with the GPIO PA11 on the SAMD21. Given its associated PWM pinmux is PA11E_TCC1_WO1 we use the tcc1 timer for the PWM."),(0,i.yg)("h4",{id:"grove---expansion-board---sd-card"},"Grove - Expansion Board - SD Card"),(0,i.yg)("p",null,"We'll use the filesystem sample here along with the Xiao Expansion Board shield to try interfacing with the SD card reader over SPI. The expansion board shield has the CS pin configured for the associated ",(0,i.yg)("inlineCode",{parentName:"p"},"&xiao_d 2")," pin so no work is needed on your part for associating this capability with the board aside from adding the shield. To further prepare it we are using a custom config that enables the SD card functionality."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/subsys/fs/fs_sample -- -DDTC_OVERLAY_FILE="$(dirname $(pwd))/applications/xiao-zephyr-examples/console.overlay $(dirname $(pwd))/applications/xiao-zephyr-examples/xiao_expansion_sd.overlay" -DEXTRA_CONF_FILE="$(dirname $(pwd))/applications/xiao-zephyr-examples/console.conf $(dirname $(pwd))/applications/xiao-zephyr-examples/xiao_expansion_sd.conf" -DSHIELD=seeed_xiao_expansion_board\n')),(0,i.yg)("p",null,"After uploading the uf2 file connect to monitor:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"screen /dev/ttyACM0 115200\n")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"*** Booting Zephyr OS build v3.6.0-2566-gc9b45bf4672a ***\n[00:00:00.197,000] <inf> sd: Maximum SD clock is under 25MHz, using clock of 10000000Hz\n[00:00:00.198,000] <inf> main: Block count 15519744\nSector size 512\nMemory Size(MB) 7578\nDisk mounted.\n\nListing dir /SD: ...\n[FILE] IMAGE1.JPG (size = 58422)\n[FILE] IMAGE2.JPG (size = 97963)\n")),(0,i.yg)("p",null,"In this case my SD card had two files. Their names and their sizes were outputted to my console."),(0,i.yg)("p",null,"Let's look over the relevant elements at play here:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"CONFIG_SPI=y\nCONFIG_DISK_DRIVER_SDMMC=y\nCONFIG_GPIO=y\n")),(0,i.yg)("p",null,"In the associated config we're enabling SPI, the SDMMC disk driver, and the GPIO. Without this config the overlay will lead to an error as the sample is unable to find the SD card."),(0,i.yg)("p",null,"The relevant part of the Xiao Expansion Board shield is actually overridden in this example via the ",(0,i.yg)("inlineCode",{parentName:"p"},"xiao_expansion_sd.overlay")," used for the Xiao SAMD21 shown below:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'&xiao_spi {\n    status = "okay";\n    cs-gpios = <&xiao_d 2 GPIO_ACTIVE_LOW>;\n\n    sdhc0: sdhc@0 {\n        compatible = "zephyr,sdhc-spi-slot";\n        reg = <0>;\n        status = "okay";\n        mmc {\n            compatible = "zephyr,sdmmc-disk";\n            status = "okay";\n        };\n        spi-max-frequency = <10000000>;\n    };\n};\n')),(0,i.yg)("p",null,"As mentioned previously the ",(0,i.yg)("inlineCode",{parentName:"p"},"&xiao_d 2")," pin mapping is used to allow the D2 pin to be selected for this regardless of the board used so long as it supports the ",(0,i.yg)("inlineCode",{parentName:"p"},"&xiao_d")," pin setup."),(0,i.yg)("p",null,"The reason we're not using the shield's overlay here but overriding it is that the ",(0,i.yg)("inlineCode",{parentName:"p"},"spi-max-frequency")," of ",(0,i.yg)("inlineCode",{parentName:"p"},"24000000")," set by the shield is too high which causes the SAMD21 to fail."),(0,i.yg)("h4",{id:"grove---temperature-and-humidity-sensor-sht31"},"Grove - Temperature and Humidity Sensor (SHT31)"),(0,i.yg)("p",null,"First solder on pins and connect your Xiao SAMD21 to the expansion board. Then connect a grove connector cable between the Grove SHT31 and one of the I2C ports on the expansion board."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/wiki-ranger/Contributions/xiao_samd21_zephyr/xiaod21_sht31.jpg",style:{width:600,height:"auto"}})),(0,i.yg)("p",null,"To test this setup we can use an existing sample with Zephyr which we will enable USB console support with our overlay and conf."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/sensor/sht3xd -- -DDTC_OVERLAY_FILE="$(dirname $(pwd))/applications/xiao-zephyr-examples/sht31.overlay $(dirname $(pwd))/applications/xiao-zephyr-examples/console.overlay" -DEXTRA_CONF_FILE=$(dirname $(pwd))/applications/xiao-zephyr-examples/console.conf\n')),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"Wait a moment for the MCU to reset after flashing and connect to monitor:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"screen /dev/ttyACM0 115200\n")),(0,i.yg)("p",null,"You will see results returned from the console:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"*** Booting Zephyr OS build v3.6.0-2566-gc9b45bf4672a ***\nSHT3XD: 26.13 Cel ; 47.34 %RH\nSHT3XD: 26.11 Cel ; 46.93 %RH\nSHT3XD: 26.14 Cel ; 46.78 %RH\nSHT3XD: 26.17 Cel ; 46.60 %RH\nSHT3XD: 26.19 Cel ; 46.25 %RH\nSHT3XD: 26.21 Cel ; 46.01 %RH\nSHT3XD: 26.21 Cel ; 45.82 %RH\nSHT3XD: 26.23 Cel ; 46.28 %RH\nSHT3XD: 26.27 Cel ; 47.11 %RH\nSHT3XD: 26.27 Cel ; 47.72 %RH\n")),(0,i.yg)("p",null,"Let's dive into this example a bit to see why it works:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},'&xiao_i2c {\n  status = "okay";\n\n  ssd1306: ssd1306@3c {\n    compatible = "solomon,ssd1306fb";\n    reg = <0x3c>;\n    width = <128>;\n    height = <64>;\n    segment-offset = <0>;\n    page-offset = <0>;\n    display-offset = <0>;\n    multiplex-ratio = <63>;\n    segment-remap;\n    com-invdir;\n    prechargep = <0x22>;\n  };\n};\n')),(0,i.yg)("p",null,"The app overlay file is used to setup various board components. Using this file the SHT31 example can be utilized as the overlay informs the ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/zephyrproject-rtos/zephyr/blob/main/samples/sensor/sht3xd/src/main.c"},"sample logic")," how to configure the sensor for our board."),(0,i.yg)("h4",{id:"169inch-lcd-display-module-240280-resolution-spi-interface"},"1.69inch LCD Display Module, 240\xd7280 Resolution, SPI Interface"),(0,i.yg)("p",null,"For this example we'll use SPI to connect to a 1.69 inch LCD with a 240x280 resolution."),(0,i.yg)("p",null,"First connect your board to the LCD screen using the following image as a guide (in this case we're using the Xiao SAMD21 but the same pin layout is used for connecting here)."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"1.69-inch LCD SPI Display"),(0,i.yg)("th",{parentName:"tr",align:null},"XIAO SAMD21"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"VCC"),(0,i.yg)("td",{parentName:"tr",align:null},"3V3")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"GND"),(0,i.yg)("td",{parentName:"tr",align:null},"GND")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"DIN"),(0,i.yg)("td",{parentName:"tr",align:null},"D10")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"CLK"),(0,i.yg)("td",{parentName:"tr",align:null},"D8")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"CS"),(0,i.yg)("td",{parentName:"tr",align:null},"D1")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"DC"),(0,i.yg)("td",{parentName:"tr",align:null},"D3")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"RST"),(0,i.yg)("td",{parentName:"tr",align:null},"D0")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"BL"),(0,i.yg)("td",{parentName:"tr",align:null},"D6")))),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/lcd_spi_display/10.png",style:{width:700,height:"auto"}})),(0,i.yg)("p",null,"Next with the hardware prepared we can build and flash:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"cd ~/zephyrproject/zephyr\nwest build -p always -b seeeduino_xiao samples/drivers/display -- -DDTC_OVERLAY_FILE=$(dirname $(pwd))/applications/xiao-zephyr-examples/240x280_st7789v2.overlay -DEXTRA_CONF_FILE=$(dirname $(pwd))/applications/xiao-zephyr-examples/240x280_st7789v2.conf\n")),(0,i.yg)("p",null,"Double press RESET or short the RST pin to the GND:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"west flash\n")),(0,i.yg)("p",null,"With the new firmware in place the device now shows the same demo screen we saw previously on the expansion board just now updated for the color LCD over SPI."),(0,i.yg)("div",{style:{textAlign:"center"}},(0,i.yg)("img",{src:"https://files.seeedstudio.com/wiki/wiki-ranger/Contributions/xiao_samd21_zephyr/spi_lcd.jpg",style:{width:600,height:"auto"}})),(0,i.yg)("h2",{id:"-contributor-project"},"\u2728 Contributor Project"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"This project is supported by the Seeed Studio ",(0,i.yg)("a",{parentName:"li",href:"https://github.com/orgs/Seeed-Studio/projects/6?pane=issue&itemId=57293601"},"Contributor Project"),"."),(0,i.yg)("li",{parentName:"ul"},"Thanks ",(0,i.yg)("strong",{parentName:"li"},"Tim's efforts")," and your work will be ",(0,i.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/Honorary-Contributors/"},"exhibited"),".")),(0,i.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,i.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,i.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,i.yg)("div",{class:"button_tech_support_container"},(0,i.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,i.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"})))}y.isMDXComponent=!0}}]);