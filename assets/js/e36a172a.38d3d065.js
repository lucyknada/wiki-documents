"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4663],{15680:(e,t,a)=>{a.d(t,{xA:()=>p,yg:()=>u});var n=a(96540);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),g=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=g(e.components);return n.createElement(s.Provider,{value:t},e.children)},m="mdxType",y={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=g(a),h=r,u=m["".concat(s,".").concat(h)]||m[h]||y[h]||l;return a?n.createElement(u,o(o({ref:t},p),{},{components:a})):n.createElement(u,o({ref:t},p))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,o=new Array(l);o[0]=h;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[m]="string"==typeof e?e:r,o[1]=i;for(var g=2;g<l;g++)o[g]=a[g];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},84085:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>y,frontMatter:()=>l,metadata:()=>i,toc:()=>g});var n=a(58168),r=(a(96540),a(15680));const l={description:"reTerminal-FAQ",title:"How to troubleshoot the black screen issue on reTerminal",image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/reterminal_black_screen",last_update:{date:"11/15/2023",author:"Kasun Thushara"}},o=void 0,i={unversionedId:"FAQ/reTerminal/reterminal_black_screen",id:"FAQ/reTerminal/reterminal_black_screen",title:"How to troubleshoot the black screen issue on reTerminal",description:"reTerminal-FAQ",source:"@site/docs/FAQ/reTerminal/reterminal_black_screen.md",sourceDirName:"FAQ/reTerminal",slug:"/reterminal_black_screen",permalink:"/reterminal_black_screen",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/FAQ/reTerminal/reterminal_black_screen.md",tags:[],version:"current",lastUpdatedBy:"Kasun Thushara",lastUpdatedAt:1700006400,formattedLastUpdatedAt:"Nov 15, 2023",frontMatter:{description:"reTerminal-FAQ",title:"How to troubleshoot the black screen issue on reTerminal",image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/reterminal_black_screen",last_update:{date:"11/15/2023",author:"Kasun Thushara"}}},s={},g=[{value:"Step 1: Check the flashing status of the LEDs",id:"step-1-check-the-flashing-status-of-the-leds",level:2},{value:"If the PWR light is not on",id:"if-the-pwr-light-is-not-on",level:3},{value:"If the PWR light is on but the SYS light is not on",id:"if-the-pwr-light-is-on-but-the-sys-light-is-not-on",level:3},{value:"If both lights are on",id:"if-both-lights-are-on",level:3},{value:"Step 2: Confirm whether you have installed a new system",id:"step-2-confirm-whether-you-have-installed-a-new-system",level:2},{value:"Install reTerminal drivers after flashing new Raspberry Pi OS/ Ubuntu OS or Other OS",id:"install-reterminal-drivers-after-flashing-new-raspberry-pi-os-ubuntu-os-or-other-os",level:3},{value:"Flash Raspberry Pi OS which is originally shipped with reTerminal",id:"flash-raspberry-pi-os-which-is-originally-shipped-with-reterminal",level:3},{value:"If the Step1/2 still fail to resolve the screen issue - Update the STM32 firmware for reTerminal LCD",id:"if-the-step12-still-fail-to-resolve-the-screen-issue---update-the-stm32-firmware-for-reterminal-lcd",level:2},{value:"Decide Which Flashing Method to Use",id:"decide-which-flashing-method-to-use",level:3},{value:"Connect to STM32 using CM4 and flash the firmware",id:"connect-to-stm32-using-cm4-and-flash-the-firmware",level:3},{value:"Connect to STM32 using jumper wires and OpenOCD",id:"connect-to-stm32-using-jumper-wires-and-openocd",level:3},{value:"Check the installed STM32G030 firmware version",id:"check-the-installed-stm32g030-firmware-version",level:3},{value:"Flash Raspberry Pi OS which is newest version - Bookworm",id:"flash-raspberry-pi-os-which-is-newest-version---bookworm",level:2}],p={toc:g},m="wrapper";function y(e){let{components:t,...a}=e;return(0,r.yg)(m,(0,n.A)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"reTerminal comes with the necessary drivers pre-installed out-of-the-box so you don't need to install any additional drivers.",(0,r.yg)("br",null),"\nHowever, if your screen is not displaying properly and remains black, please follow the troubleshooting steps below to identify and resolve the issue by step."),(0,r.yg)("h2",{id:"step-1-check-the-flashing-status-of-the-leds"},"Step 1: Check the flashing status of the LEDs"),(0,r.yg)("h3",{id:"if-the-pwr-light-is-not-on"},"If the PWR light is not on"),(0,r.yg)("p",null,"  You should verify the status of the power supply because there can be a power supply problem. Additionally, to rule out any hardware difficulties, ensure that the CM4 module within the reTerminal is properly connected."),(0,r.yg)("h3",{id:"if-the-pwr-light-is-on-but-the-sys-light-is-not-on"},"If the PWR light is on but the SYS light is not on"),(0,r.yg)("p",null,'  You need to flash the original factory system again. You can proceed directly to this section."'),(0,r.yg)("h3",{id:"if-both-lights-are-on"},"If both lights are on"),(0,r.yg)("p",null,"  This situation occurs due to issues with the driver controlling the LCD screen. At this point, please follow the troubleshooting steps provided in the ",(0,r.yg)("a",{parentName:"p",href:"/reterminal_black_screen/#second-confirm-whether-you-have-installed-a-new-system"},(0,r.yg)("strong",{parentName:"a"},"second step"))," and execute them by step."),(0,r.yg)("h2",{id:"step-2-confirm-whether-you-have-installed-a-new-system"},"Step 2: Confirm whether you have installed a new system"),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("ul",{parentName:"admonition"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"If you flash new OS by yourself and the LCD screen fails to display properly, you need to ",(0,r.yg)("a",{parentName:"p",href:"/reterminal_black_screen/#install-reterminal-drivers-after-flashing-new-raspberry-pi-os-ubuntu-os-or-other-os"},(0,r.yg)("strong",{parentName:"a"},"install the necessary reTerminal drivers"))," separately.")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"If you haven't flashed your own OS but the screen remains black, please proceed directly to ",(0,r.yg)("a",{parentName:"p",href:"/reterminal_black_screen/#flash-raspberry-pi-os-which-is-originally-shipped-with-reterminal"},(0,r.yg)("strong",{parentName:"a"},"Flash Raspberry Pi OS which is originally shipped with reTerminal")),".")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"If you are attempting to install ",(0,r.yg)("strong",{parentName:"p"},"Raspbian OS"),", we have conducted tests and found that both the ",(0,r.yg)("em",{parentName:"p"},"32-bit and 64-bit")," versions of ",(0,r.yg)("strong",{parentName:"p"},"Bulleseye")," work well with reTerminal without encountering any ",(0,r.yg)("strong",{parentName:"p"},"black screen issue"),". Additionally, we have also tested the new ",(0,r.yg)("strong",{parentName:"p"},"Bookworm")," ",(0,r.yg)("em",{parentName:"p"},"64-bit")," version, and it functions smoothly on reTerminal.")))),(0,r.yg)("h3",{id:"install-reterminal-drivers-after-flashing-new-raspberry-pi-os-ubuntu-os-or-other-os"},"Install reTerminal drivers after flashing new Raspberry Pi OS/ Ubuntu OS or Other OS"),(0,r.yg)("p",null,"The hardware that need drivers include the ",(0,r.yg)("strong",{parentName:"p"},"5-inch LCD, touch panel, accelerometer, light sensor, user LEDs, user buttons, RTC, buzzer, cryptographic co-processor"),".\nTherefore, installing this driver enables the proper functioning of the LCD screen while using new Raspberry Pi OS/ Ubuntu OS or Other OS."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"1.")," Clone the following repo")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo apt install git -y\ngit clone --depth 1 https://github.com/Seeed-Studio/seeed-linux-dtoverlays\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"2.")," Enter the repo")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"cd seeed-linux-dtoverlays\n")),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"For ",(0,r.yg)("strong",{parentName:"p"},"32bit OS")," you will need to add following step before execute ",(0,r.yg)("inlineCode",{parentName:"p"},"sudo ./scripts/reTerminal.sh"),".After completing the installation, remember to ",(0,r.yg)("strong",{parentName:"p"},"reboot")," reTerminal for the changes to take effect."),(0,r.yg)("pre",{parentName:"admonition"},(0,r.yg)("code",{parentName:"pre"},"echo arm_64bit=0 | sudo tee -a /boot/config.txt\nsudo reboot\n"))),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"3.")," Type the following to install the drivers")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo ./scripts/reTerminal.sh\n")),(0,r.yg)("p",null,"You will see the following output if you have successfully installed the drivers"),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"http://files.seeedstudio.com/wiki/ReTerminal/driver-success.png",alt:"pir",width:"1000",height:"auto"})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"4.")," Reboot the reTerminal")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo reboot\n")),(0,r.yg)("p",null,"Finally, you can use the LCD screen normally on the new system."),(0,r.yg)("h3",{id:"flash-raspberry-pi-os-which-is-originally-shipped-with-reterminal"},"Flash Raspberry Pi OS which is originally shipped with reTerminal"),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"If you have flashed to a different OS and want to switch back to the default Raspberry Pi OS which is shipped with reTerminal, you can follow the steps below")),(0,r.yg)("p",null,"We can flash ",(0,r.yg)("strong",{parentName:"p"},"Raspberry Pi OS / 64-bit Ubuntu OS or other OS")," on to the ",(0,r.yg)("strong",{parentName:"p"},"eMMC storage")," of the CM4 on the reTerminal. If you have never flashed a system on reTerminal before, we strongly advise you to follow ",(0,r.yg)("a",{parentName:"p",href:"/flash_different_os_to_emmc"},"Flash Raspberry Pi OS/ 64-bit Ubuntu OS or Other OS to eMMC")," to prepare for the system flashing, which includes ",(0,r.yg)("strong",{parentName:"p"},"installing the necessary drivers"),"."),(0,r.yg)("p",null,"Once the ",(0,r.yg)("a",{parentName:"p",href:"/flash_different_os_to_emmc"},"necessary drivers")," are installed, you just have to connect the USB Type-C port of the reTerminal to your PC. When you open File Explorer and see that the eMMC of Compute Module 4 is displayed as a USB mass storage device, you can perform the following steps:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"1.")," Download the Raspberry Pi OS by visiting the links below"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReTerminal/RPiOS_Images/2022-07-21-Raspbian-reTerminal-arm64/32bit-20220721T012743Z-001.zip"},"32-bit 2022-07-21-Raspbian-reTerminal")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReTerminal/RPiOS_Images/2022-07-21-Raspbian-reTerminal-arm64/64bit-20220721T012743Z-001.zip"},"64-bit 2022-07-21-Raspbian-reTerminal"))))),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," reTerminal is originally shipped with 32-bit OS. However, you can download a 64-bit version as well"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"2.")," Extract the ",(0,r.yg)("strong",{parentName:"p"},".zip file"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"3.")," Open Raspberry Pi Imager software"))),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/102110497/RPI_Imager.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"4.")," Press ",(0,r.yg)("strong",{parentName:"li"},"CTRL + SHIFT + X")," on the keyboard to open ",(0,r.yg)("strong",{parentName:"li"},"Advanced options")," window")),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"http://files.seeedstudio.com/wiki/ReTerminal/rpi-imager-advanced.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("p",null,"Here you can ",(0,r.yg)("strong",{parentName:"p"},"set a hostname, enable SSH, set a password, configure wifi, set locale settings")," and more"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"5.")," Click ",(0,r.yg)("strong",{parentName:"li"},"CHOOSE OS")," and select ",(0,r.yg)("strong",{parentName:"li"},"Use custom"))),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/ReTerminal/factory-os.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"6.")," Navigate to the previously extracted image, select it and click ",(0,r.yg)("strong",{parentName:"p"},"open"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"7.")," Click ",(0,r.yg)("strong",{parentName:"p"},"CHOOSE STORAGE")," and select the connected eMMC drive")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"8.")," Finally, click ",(0,r.yg)("strong",{parentName:"p"},"WRITE")))),(0,r.yg)("p",null,"Finally, you can use the LCD screen normally on the original system."),(0,r.yg)("h2",{id:"if-the-step12-still-fail-to-resolve-the-screen-issue---update-the-stm32-firmware-for-reterminal-lcd"},"If the Step1/2 still fail to resolve the screen issue - Update the STM32 firmware for reTerminal LCD"),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"If your reTerminal is manufactured after 26/09/2021, the STM32 comes with V1.8 firmware pre-installed.")),(0,r.yg)("p",null,"It is very important to make sure that you have the latest firmware flashed on to the STM32G030 chip on the reTerminal. STM32G030 is responsible to drive the LCD on the reTerminal. Updating the STM32 chip to the latest version will be helpful to solve most of the issues that you face with the reTerminal LCD."),(0,r.yg)("p",null,"There are 2 methods of flashing the STM32 chip."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Method 1:")," Directly connect to STM32 chip using the CM4 on the reTerminal and flash the firmware"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Method 2:")," Physically connect the STM32 chip pins to the 40-Pin reTerminal GPIO using jumper wires and then use OpenOCD to flash the firmware")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Method 1")," works if you have the ",(0,r.yg)("strong",{parentName:"p"},"new version (v1.7 or higher)")," of the STM32 firmware on the reTerminal and on the other hand, ",(0,r.yg)("strong",{parentName:"p"},"method 2")," is only needed if you have the ",(0,r.yg)("strong",{parentName:"p"},"old version (lower than v1.7)")," of the STM32 firmware on the board."),(0,r.yg)("h3",{id:"decide-which-flashing-method-to-use"},"Decide Which Flashing Method to Use"),(0,r.yg)("p",null,"Now let's go through the following steps to identify which version of the board we have so that we can choose the appropriate flashing method."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"1.")," Enter terminal window of reTerminal and type the following to open the configuration file")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo nano /boot/config.txt\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"2.")," At the very bottom of this file, comment out the line which says ",(0,r.yg)("strong",{parentName:"li"},"dtoverlay=reTerminal"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"#dtoverlay=reTerminal\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," This will unload all the reTerminal drivers. So when you turn on the reTerminal next time, none of the drivers will be loaded."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"3.")," Reboot reTerminal")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo reboot\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"4.")," Make STM32 enter ",(0,r.yg)("strong",{parentName:"li"},"boot mode")," through ",(0,r.yg)("strong",{parentName:"li"},"i2c-tools"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"i2ctransfer -y 1 w2@0x45 0x9b 0x01\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"5.")," List the connected I2C devices")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"i2cdetect -y 1\n")),(0,r.yg)("p",null,"If you can see the I2C address ",(0,r.yg)("strong",{parentName:"p"},"0x56")," as the table below, you have the ",(0,r.yg)("strong",{parentName:"p"},"new version (v1.7 or higher)")," of the STM32 firmware on the board."),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"http://files.seeedstudio.com/wiki/ReTerminal/i2c-new-board.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("p",null,"However, if you can see the I2C address ",(0,r.yg)("strong",{parentName:"p"},"0x45")," as the table below, you have the ",(0,r.yg)("strong",{parentName:"p"},"old version (lower than v1.7)")," of the STM32 firmware on the board"),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"http://files.seeedstudio.com/wiki/ReTerminal/i2c-old-board.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"6.")," Open the configuration file that we used before")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo nano /boot/config.txt\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"7.")," At the very bottom of this file, uncomment the line which says ",(0,r.yg)("strong",{parentName:"li"},"dtoverlay=reTerminal")," to load the drivers again")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"dtoverlay=reTerminal\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"8.")," Power off reTerminal")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo poweroff\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," If you are already running ",(0,r.yg)("strong",{parentName:"p"},"STM32 v1.8 firmware"),", once you enter ",(0,r.yg)("strong",{parentName:"p"},"boot mode")," through ",(0,r.yg)("strong",{parentName:"p"},"i2c-tools"),", the only way to come out of boot mode is to flash the STM32 firmware."),(0,r.yg)("h3",{id:"connect-to-stm32-using-cm4-and-flash-the-firmware"},"Connect to STM32 using CM4 and flash the firmware"),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"If you have the ",(0,r.yg)("strong",{parentName:"p"},"new version (v1.7 or higher)")," of the STM32 firmware on the board, please follow this method.")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"1.")," Enter terminal window of reTerminal and type the following to open the configuration file")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo nano /boot/config.txt\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"2.")," At the very bottom of this file, comment out the line which says ",(0,r.yg)("strong",{parentName:"li"},"dtoverlay=reTerminal"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"#dtoverlay=reTerminal\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"3.")," Reboot reTerminal")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo reboot\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"4.")," Make a new directory inside reTerminal and enter it.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"mkdir STM32\ncd STM32\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"5.")," Download ",(0,r.yg)("strong",{parentName:"li"},"stm32flash")," file and the ",(0,r.yg)("strong",{parentName:"li"},"STM32G030F6_R2.bin"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"wget https://sourceforge.net/projects/stm32flash/files/stm32flash-0.7.tar.gz \n")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"wget https://github.com/Seeed-Studio/seeed-linux-dtoverlays/releases/download/2022-05-29-reTerminal-V1.9/STM32G030F6_R2.bin\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"6.")," Unpack ",(0,r.yg)("strong",{parentName:"li"},"stm32flash-0.7.tar.gz"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"tar -xvf stm32flash-0.7.tar.gz\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"7.")," Go to the folder named ",(0,r.yg)("strong",{parentName:"li"},"stm32flash-0.7")," and make the flash tool executable")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"cd stm32flash-0.7/\nmake\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"8.")," Make STM32 enter ",(0,r.yg)("strong",{parentName:"li"},"boot mode")," through ",(0,r.yg)("strong",{parentName:"li"},"i2c-tools"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"i2ctransfer -y 1 w2@0x45 0x9b 0x01\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"9.")," Erase the flash in the STM32 chip using ",(0,r.yg)("strong",{parentName:"li"},"stm32flash tool"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"./stm32flash -a 0x56 -o /dev/i2c-1\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"10.")," Flash the firmware to STM32 using stm32flash tool")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"./stm32flash -a 0x56 -w ../STM32G030F6_R2.bin -v -g 0x0 /dev/i2c-1\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," ",(0,r.yg)("strong",{parentName:"p"},"STM32G030F6_R2.bin")," is the file name of the new firmware"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"11.")," Modify the OPTR register as follows")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"i2ctransfer -y 1 w2@0x45 0x9b 0x00\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"12.")," Open the configuration file that we used before")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo nano /boot/config.txt\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"13.")," At the very bottom of this file, uncomment the line which says ",(0,r.yg)("strong",{parentName:"li"},"dtoverlay=reTerminal"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"dtoverlay=reTerminal\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"14.")," Reboot reTerminal")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo reboot\n")),(0,r.yg)("p",null,"Now you have successfully flashed the firmware to STM32!"),(0,r.yg)("h3",{id:"connect-to-stm32-using-jumper-wires-and-openocd"},"Connect to STM32 using jumper wires and OpenOCD"),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"If you have the ",(0,r.yg)("strong",{parentName:"p"},"old version (lower than v1.7)")," of the STM32 firmware on the board, please follow this method.")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"1.")," Enter terminal window of reTerminal and type the following to update the packages list")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo apt-get update\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"2.")," Install the following packages")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo apt-get install git autoconf libtool make pkg-config libusb-1.0-0 libusb-1.0-0-dev\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"3.")," Clone the following repo and navigate to it")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"git clone http://openocd.zylin.com/openocd\ncd openocd\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"4.")," Visit ",(0,r.yg)("a",{parentName:"li",href:"https://github.com/Seeed-Studio/seeed-linux-dtoverlays/releases"},"this link")," and download the ",(0,r.yg)("strong",{parentName:"li"},"STM32G030F6_R2.bin")," file from the ",(0,r.yg)("strong",{parentName:"li"},"latest release")," version.")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," You can click on it to start downloading"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"5.")," Open command prompt on PC and navigate to the location of the downloaded files before")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"cd C:\\Users\\user\\Downloads\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"6.")," Transfer the files to the ",(0,r.yg)("strong",{parentName:"li"},"openocd")," directory on the reTerminal we created before")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"scp -r .\\STM32G030F6_R2.bin pi@192.168.x.xx:\\home\\pi\\openocd\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," ",(0,r.yg)("strong",{parentName:"p"},"pi")," is the username and ",(0,r.yg)("strong",{parentName:"p"},"192.168.x.xx")," is the IP address of reTerminal. You can replace this with hostname of reTerminal as well."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"7.")," Come back to terminal window on reterminal and enter the following inside the ",(0,r.yg)("strong",{parentName:"li"},"openocd")," directory")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"./bootstrap\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"8.")," Enter the following")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"./configure --enable-sysfsgpio --enable-bcm2835gpio\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"9.")," Compile it")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"make\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"10.")," Install it")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo make install\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"11.")," Follow the connection below to connect the pins from STM32 to 40-Pin GPIO")),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/ReTerminal/FAQ/pinout-stm32.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," The STM32 pins are located at the back of reTerminal PCBA."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"12.")," While keeping the connection, enter the following command to flash the firmware to STM32")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},'openocd -f interface/sysfsgpio-raspberrypi.cfg -c "transport select swd" -f target/stm32g0x.cfg -c "program STM32G030F6_R2.bin verify 0x08000000;shutdown"\n')),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," Normally it takes about 3 seconds to finish flashing. So you need to ",(0,r.yg)("strong",{parentName:"p"},"hold")," the above connection for about ",(0,r.yg)("strong",{parentName:"p"},"3 seconds")," until the flashing process is complete"),(0,r.yg)("p",null,"If you see the following log, that means the STM32 firmware is successfully flashed!"),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/ReTerminal/openocd-log.jpg",alt:"pir",width:350,height:"auto"})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"13.")," Disconect the connections and ",(0,r.yg)("strong",{parentName:"li"},"physically disconnect the power cord directly")," without ",(0,r.yg)("strong",{parentName:"li"},"poweroff")," command")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Note:")," If you don't physically unplug the power cord, STM32 firmware will not load successfully"),(0,r.yg)("p",null,"Now you have successfully flashed the firmware to STM32!"),(0,r.yg)("h3",{id:"check-the-installed-stm32g030-firmware-version"},"Check the installed STM32G030 firmware version"),(0,r.yg)("p",null,"Now let's check the installed STM32 firmware version"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"1.")," Enter terminal window of reTerminal and type the following to open the configuration file")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo nano /boot/config.txt\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"2.")," At the very bottom of this file, comment out the line which says ",(0,r.yg)("strong",{parentName:"li"},"dtoverlay=reTerminal"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"#dtoverlay=reTerminal\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"3.")," Reboot reTerminal")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"4.")," Enter the following inside terminal window of reTerminal to check the STM32 firmware version"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"i2ctransfer -y 1 w1@0x45 0x97 r2\n")),(0,r.yg)("p",null,"If the output looks like ",(0,r.yg)("strong",{parentName:"p"},"0x01 0x07"),", that means you are using firmware version 1.7"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"5.")," Open the configuration file that we used before")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo nano /boot/config.txt\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"6.")," At the very bottom of this file, uncomment the line which says ",(0,r.yg)("strong",{parentName:"li"},"dtoverlay=reTerminal"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"dtoverlay=reTerminal\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"7.")," Reboot reTerminal")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"sudo reboot\n")),(0,r.yg)("h2",{id:"flash-raspberry-pi-os-which-is-newest-version---bookworm"},"Flash Raspberry Pi OS which is newest version - Bookworm"),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/ReTerminal/RPiOS_Images/2023_11_15_bookworm_64_reTerminal/bookworm.jpeg",alt:"pir",width:600,height:"auto"})),(0,r.yg)("p",null,"We have prepared an image with the latest Bookworm OS, the newest release from Raspberry Pi officials. If you encounter any issues, especially those discussed above, we highly recommend following these steps for a smoother experience."),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"Before proceeding, ensure that you ",(0,r.yg)("strong",{parentName:"p"},"flip down the boot mode switch"),". Next, launch the ",(0,r.yg)("strong",{parentName:"p"},"rpiboot setup installer"),". Detailed instructions on how to perform these steps are provided ",(0,r.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/flash_different_os_to_emmc/"},(0,r.yg)("strong",{parentName:"a"},"here")),".")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"1.")," Download the Raspberry Pi OS by visiting the links below"))),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Version"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"),(0,r.yg)("th",{parentName:"tr",align:null},"TAG"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"https://files.seeedstudio.com/wiki/ReTerminal/RPiOS_Images/2024-03-14-Raspbian-reTerminal/2024-03-14-Raspbian-reTerminal-arm64.zip"},"2024-03-14-Raspbian-reTerminal-arm64")),(0,r.yg)("td",{parentName:"tr",align:null},"64bit Debian12(bookworm) Linux version 6.6.20"),(0,r.yg)("td",{parentName:"tr",align:null},"lastest")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"https://files.seeedstudio.com/wiki/ReTerminal/RPiOS_Images/2024-03-14-Raspbian-reTerminal/2024-03-14-Raspbian-reTerminal-armhf.zip"},"2024-03-14-Raspbian-reTerminal-armhf")),(0,r.yg)("td",{parentName:"tr",align:null},"32bit Debian12(bookworm) Linux version 6.6.20"),(0,r.yg)("td",{parentName:"tr",align:null},"lastest")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"https://files.seeedstudio.com/wiki/ReTerminal/RPiOS_Images/2023_11_15_bookworm_64_reTerminal/2023_11_15_bookworm_64.img.gz"},"2023_11_15_bookworm_64.img.gz")),(0,r.yg)("td",{parentName:"tr",align:null},"64bit Debian12(bookworm) Linux version 6.1"),(0,r.yg)("td",{parentName:"tr",align:null},"release")))),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"2.")," Extract the ",(0,r.yg)("strong",{parentName:"p"},".zip file"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"3.")," Open Raspberry Pi Imager software"))),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/102110497/RPI_Imager.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"4.")," Press ",(0,r.yg)("strong",{parentName:"li"},"CTRL + SHIFT + X")," on the keyboard to open ",(0,r.yg)("strong",{parentName:"li"},"Advanced options")," window")),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"http://files.seeedstudio.com/wiki/ReTerminal/rpi-imager-advanced.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("p",null,"Here you can ",(0,r.yg)("strong",{parentName:"p"},"set a hostname, enable SSH, set a password, configure wifi, set locale settings")," and more"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"5.")," Click ",(0,r.yg)("strong",{parentName:"li"},"CHOOSE OS")," and select ",(0,r.yg)("strong",{parentName:"li"},"Use custom"))),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/ReTerminal/factory-os.png",alt:"pir",width:600,height:"auto"})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"6.")," Navigate to the previously extracted image, select it and click ",(0,r.yg)("strong",{parentName:"p"},"open"))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"7.")," Click ",(0,r.yg)("strong",{parentName:"p"},"CHOOSE STORAGE")," and select the connected eMMC drive")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"8.")," Finally, click ",(0,r.yg)("strong",{parentName:"p"},"WRITE")))),(0,r.yg)("p",null,"Finally, ",(0,r.yg)("strong",{parentName:"p"},"Flip the Boot Mode switch*")," back to the original postion and assemble the reTerminal shell. Then ",(0,r.yg)("strong",{parentName:"p"},"turn on the power"),". you can use the LCD screen normally on the original system."))}y.isMDXComponent=!0}}]);